<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>kmk3593 blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="kmk3593 blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="kmk3593 blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="kmk3593 blog"><meta property="og:url" content="https://kmk3593.github.io/"><meta property="og:site_name" content="kmk3593 blog"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://kmk3593.github.io/img/og_image.png"><meta property="article:author" content="John Doe"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://kmk3593.github.io"},"headline":"kmk3593 blog","image":["https://kmk3593.github.io/img/og_image.png"],"author":{"@type":"Person","name":"John Doe"},"publisher":{"@type":"Organization","name":"kmk3593 blog","logo":{"@type":"ImageObject","url":"https://kmk3593.github.io/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 6.1.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="kmk3593 blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-22T00:00:00.000Z" title="2022. 5. 22. 오전 9:00:00">2022-05-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-30T12:09:40.920Z" title="2022. 5. 30. 오후 9:09:40">2022-05-30</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/PL-SQL/">PL/SQL</a></span><span class="level-item">4 minutes read (About 640 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/22/PL_SQL_ML/">PL/SQL - ML</a></h1><div class="content"><h3 id="사전준비"><a href="#사전준비" class="headerlink" title="사전준비"></a>사전준비</h3><ul>
<li>두 파일을 다운로드</li>
</ul>
<p><a href="/images/PL_SQL_ML/hr.csv">hr.csv</a></p>
<p><a href="/images/PL_SQL_ML/pl_sql_ml_modeling.sql">pl_sql_ml_modeling.sql</a></p>
<ul>
<li><p>SQL Developer에서 데이터 임포트한다.</p>
<ul>
<li>hr.csv를 임포트해야 한다.</li>
</ul>
</li>
<li><p>새 SQL 워크시트에서 pl_sql_ml_modeling.sql 내용을 넣는다.</p>
<ul>
<li>메모장으로 열어서 내용을 복사하고 워크시트에 붙이면 된다.</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 의사 결정 트리 모델로 퇴사자 예측 모델 만들기</span></span><br><span class="line"><span class="comment">-- 데이터셋 : https://www.kaggle.com/datasets/pankeshpatel/hrcommasep</span></span><br><span class="line"><span class="comment">-- 기존에 있을지도 모를 HR 데이터 삭제</span></span><br><span class="line"><span class="comment">-- 퇴사 여부 예측 (LEFT)</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> HR_DATA_MAIN;</span><br><span class="line"><span class="comment">-- 14999</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 훈련 데이터와 테스트 데이터로 분리</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> HR_DATA_TRAINING; </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> HR_DATA_TRAINING</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">   <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">     <span class="keyword">FROM</span> HR_DATA_MAIN</span><br><span class="line">     <span class="keyword">WHERE</span> EMP_ID <span class="operator">&lt;</span> <span class="number">10500</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> HR_DATA_TEST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> HR_DATA_TEST</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">   <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">     <span class="keyword">FROM</span> HR_DATA_MAIN</span><br><span class="line">     <span class="keyword">WHERE</span> EMP_ID <span class="operator">&gt;=</span> <span class="number">10500</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 머신 러닝 모델의 환경설정을 위한 정보가 들어있는 테이블을 생성합니다. </span></span><br><span class="line"><span class="comment">-- URL : https://docs.oracle.com/database/121/ARPLS/d_datmin.htm#ARPLS192</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> DTSETTINGS;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DTSETTINGS</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">TABLE</span> (DBMS_DATA_MINING.GET_DEFAULT_SETTINGS)</span><br><span class="line">  <span class="keyword">WHERE</span> SETTING_NAME <span class="keyword">LIKE</span> <span class="string">&#x27;%GLM%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">INSERT</span> <span class="keyword">INTO</span> DTSETTINGS</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="string">&#x27;ALGO_NAME&#x27;</span>, <span class="string">&#x27;ALGO_DECISION_TREE&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">INSERT</span> <span class="keyword">INTO</span> DTSETTINGS</span><br><span class="line">     <span class="keyword">VALUES</span> (DBMS_DATA_MINING.TREE_IMPURITY_METRIC, <span class="string">&#x27;TREE_IMPURITY_ENTROPY&#x27;</span>); <span class="comment">-- 모델의 핵심엔진은 엔트로피로 설정</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 머신 러닝 모델을 생성합니다.</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  DBMS_DATA_MINING.DROP_MODEL(<span class="string">&#x27;DT_MODEL&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   DBMS_DATA_MINING.CREATE_MODEL (</span><br><span class="line">      MODEL_NAME            <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;DT_MODEL&#x27;</span>,</span><br><span class="line">      MINING_FUNCTION       <span class="operator">=</span><span class="operator">&gt;</span> DBMS_DATA_MINING.CLASSIFICATION,</span><br><span class="line">      DATA_TABLE_NAME       <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;HR_DATA_TRAINING&#x27;</span>,</span><br><span class="line">      CASE_ID_COLUMN_NAME   <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;EMP_ID&#x27;</span>,</span><br><span class="line">      TARGET_COLUMN_NAME    <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;LEFT&#x27;</span>,</span><br><span class="line">      SETTINGS_TABLE_NAME   <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;DTSETTINGS&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5. 생성된 모델을 확인합니다.</span></span><br><span class="line"><span class="keyword">SELECT</span> MODEL_NAME,</span><br><span class="line">          ALGORITHM,</span><br><span class="line">          MINING_FUNCTION</span><br><span class="line">  <span class="keyword">FROM</span> ALL_MINING_MODELS</span><br><span class="line">  <span class="keyword">WHERE</span> MODEL_NAME <span class="operator">=</span> <span class="string">&#x27;DT_MODEL&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. 생성된 모델의 환경설정 내용을 확인합니다. </span></span><br><span class="line"><span class="keyword">SELECT</span> SETTING_NAME, SETTING_VALUE</span><br><span class="line">  <span class="keyword">FROM</span> ALL_MINING_MODEL_SETTINGS</span><br><span class="line">  <span class="keyword">WHERE</span> MODEL_NAME <span class="operator">=</span> <span class="string">&#x27;DT_MODEL&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7. 실제 값과 예측 값과 예측 확률을 출력합니다. </span></span><br><span class="line"><span class="keyword">SELECT</span> EMP_ID, T.LEFT 실제값,</span><br><span class="line">          PREDICTION (DT_MODEL <span class="keyword">USING</span> <span class="operator">*</span>) 예측값,</span><br><span class="line">          PREDICTION_PROBABILITY (DT_MODEL <span class="keyword">USING</span> <span class="operator">*</span>) &quot;모델이 예측한 확률&quot;</span><br><span class="line">  <span class="keyword">FROM</span> HR_DATA_TEST T;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8. 학습한 머신러닝 모델의 성능을 확인합니다.</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> HR_DATA_TEST_MATRIX_2;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span>   VIEW_HR_DATA_TEST</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> EMP_ID, PREDICTION(DT_MODEL <span class="keyword">USING</span> <span class="operator">*</span>) PREDICTED_VALUE,</span><br><span class="line">          PREDICTION_PROBABILITY(DT_MODEL <span class="keyword">USING</span> <span class="operator">*</span> ) PROBABILITY</span><br><span class="line">  <span class="keyword">FROM</span> HR_DATA_TEST;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">SET</span> SERVEROUTPUT <span class="keyword">ON</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   V_ACCURACY NUMBER;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   DBMS_DATA_MINING.COMPUTE_CONFUSION_MATRIX (</span><br><span class="line">      ACCURACY           <span class="operator">=</span><span class="operator">&gt;</span> V_ACCURACY,</span><br><span class="line">      APPLY_RESULT_TABLE_NAME      <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;VIEW_HR_DATA_TEST&#x27;</span>,</span><br><span class="line">      TARGET_TABLE_NAME       <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;HR_DATA_TEST&#x27;</span>,</span><br><span class="line">      CASE_ID_COLUMN_NAME       <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;EMP_ID&#x27;</span>,</span><br><span class="line">      TARGET_COLUMN_NAME       <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;LEFT&#x27;</span>,</span><br><span class="line">      CONFUSION_MATRIX_TABLE_NAME <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;HR_DATA_TEST_MATRIX_2&#x27;</span>,</span><br><span class="line">      SCORE_COLUMN_NAME       <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;PREDICTED_VALUE&#x27;</span>,</span><br><span class="line">      SCORE_CRITERION_COLUMN_NAME <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;PROBABILITY&#x27;</span>,</span><br><span class="line">      COST_MATRIX_TABLE_NAME      <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">NULL</span>,</span><br><span class="line">      APPLY_RESULT_SCHEMA_NAME    <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">NULL</span>,</span><br><span class="line">      TARGET_SCHEMA_NAME       <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">NULL</span>,</span><br><span class="line">      COST_MATRIX_SCHEMA_NAME     <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">NULL</span>,</span><br><span class="line">      SCORE_CRITERION_TYPE       <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;PROBABILITY&#x27;</span>);</span><br><span class="line">   DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;**** MODEL ACCURACY ****: &#x27;</span> <span class="operator">||</span> ROUND(V_ACCURACY,<span class="number">4</span>));</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-21T00:00:00.000Z" title="2022. 5. 21. 오전 9:00:00">2022-05-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-29T01:48:53.493Z" title="2022. 5. 29. 오전 10:48:53">2022-05-29</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/PL-SQL/">PL/SQL</a></span><span class="level-item">7 minutes read (About 1068 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/21/PL_SQL_practice_2/">PL/SQL practice02</a></h1><div class="content"><ul>
<li>PL&#x2F;SQL은 일반 프로그래밍 언어에서 제공하는 많은 기능이 탑재되어 있다.</li>
<li>다른 프로그래밍 언어와 다른 점은 PL&#x2F;SQL은 DB에 직접 탑재되어 컴파일되고 실행되어 성능 면에서도 우수하고, DB 관련 처리를 할 때 수많은 기능을 제공한다</li>
</ul>
<h3 id="프로시저"><a href="#프로시저" class="headerlink" title="프로시저"></a>프로시저</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 프로시저</span></span><br><span class="line"><span class="comment">-- 함수와 다르게 로직 처리만 수행 / 결괏값 반환 (X)</span></span><br><span class="line"><span class="comment">-- p.290</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> JOBS;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 프로시저 생성</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> my_new_job_proc</span><br><span class="line">(p_job_id <span class="keyword">IN</span> JOBS.JOB_ID<span class="operator">%</span>TYPE</span><br><span class="line"> , p_job_title <span class="keyword">IN</span> JOBS.JOB_TITLE<span class="operator">%</span>TYPE</span><br><span class="line"> , p_min_sal <span class="keyword">IN</span> JOBS.MIN_SALARY<span class="operator">%</span>TYPE</span><br><span class="line"> , p_max_sal <span class="keyword">IN</span> JOBS.MAX_SALARY<span class="operator">%</span>TYPE</span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> JOBS(job_id</span><br><span class="line">                     , job_title</span><br><span class="line">                     , min_salary</span><br><span class="line">                     , max_salary</span><br><span class="line">                     , create_date</span><br><span class="line">                     , update_date) </span><br><span class="line">    <span class="keyword">VALUES</span>(p_job_id, p_job_title, p_min_sal, p_max_sal, SYSDATE, SYSDATE);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="프로시저-실행"><a href="#프로시저-실행" class="headerlink" title="프로시저 실행"></a>프로시저 실행</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 프로시저 실행</span></span><br><span class="line"><span class="comment">-- exec</span></span><br><span class="line"><span class="keyword">EXEC</span> my_new_job_proc (<span class="string">&#x27;SM_JOB1&#x27;</span>, <span class="string">&#x27;Sample JOB1&#x27;</span>, <span class="number">1000</span>, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 확인</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;SM_JOB1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 프로시저 업데이트 </span></span><br><span class="line"><span class="comment">-- 끊기면 안되고, 계속 실행이 되어야 함</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> my_new_job_proc</span><br><span class="line">(p_job_id <span class="keyword">IN</span> JOBS.JOB_ID<span class="operator">%</span>TYPE</span><br><span class="line"> , p_job_title <span class="keyword">IN</span> JOBS.JOB_TITLE<span class="operator">%</span>TYPE</span><br><span class="line"> , p_min_sal <span class="keyword">IN</span> JOBS.MIN_SALARY<span class="operator">%</span>TYPE</span><br><span class="line"> , p_max_sal <span class="keyword">IN</span> JOBS.MAX_SALARY<span class="operator">%</span>TYPE</span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">    vn_cnt NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 동일한 JOB_ID가 있는지 체크</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">        <span class="keyword">INTO</span> vn_cnt</span><br><span class="line">    <span class="keyword">FROM</span> JOBS</span><br><span class="line">    <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 없으면 INSERT </span></span><br><span class="line">    IF vn_cnt <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span> </span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> JOBS(job_id</span><br><span class="line">                     , job_title</span><br><span class="line">                     , min_salary</span><br><span class="line">                     , max_salary</span><br><span class="line">                     , create_date</span><br><span class="line">                     , update_date) </span><br><span class="line">        <span class="keyword">VALUES</span>(p_job_id, p_job_title, p_min_sal, p_max_sal, SYSDATE, SYSDATE);</span><br><span class="line">    <span class="keyword">ELSE</span> <span class="comment">-- 있으면 UPDATE</span></span><br><span class="line">        <span class="keyword">UPDATE</span> JOBS </span><br><span class="line">            <span class="keyword">SET</span> job_title    <span class="operator">=</span> p_job_title</span><br><span class="line">            ,   min_salary   <span class="operator">=</span> p_min_sal</span><br><span class="line">            ,   max_salary   <span class="operator">=</span> p_max_sal</span><br><span class="line">            ,   update_date  <span class="operator">=</span> SYSDATE</span><br><span class="line">        <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="프로시저-실행-1"><a href="#프로시저-실행-1" class="headerlink" title="프로시저 실행"></a>프로시저 실행</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 프로시저 실행</span></span><br><span class="line"><span class="comment">-- exec</span></span><br><span class="line"><span class="keyword">EXEC</span> my_new_job_proc (<span class="string">&#x27;SM_JOB1&#x27;</span>, <span class="string">&#x27;Sample JOB1&#x27;</span>, <span class="number">1000</span>, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;SM_JOB1&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- p.293</span></span><br><span class="line"><span class="comment">-- 한줄로 실행. (이유 모름)</span></span><br><span class="line"><span class="keyword">EXECUTE</span> my_new_job_proc (p_job_id <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;SM_JOB1&#x27;</span>, p_job_title <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;Sample JOB1&#x27;</span>, p_min_sal <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">2000</span>, p_max_sal <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">7000</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> jobs <span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;SM_JOB1&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 매개변수 디폴트 설정</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> my_new_job_proc</span><br><span class="line">(p_job_id <span class="keyword">IN</span> JOBS.JOB_ID<span class="operator">%</span>TYPE</span><br><span class="line"> , p_job_title <span class="keyword">IN</span> JOBS.JOB_TITLE<span class="operator">%</span>TYPE</span><br><span class="line"> , p_min_sal <span class="keyword">IN</span> JOBS.MIN_SALARY<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">10</span></span><br><span class="line"> , p_max_sal <span class="keyword">IN</span> JOBS.MAX_SALARY<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">100</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">    vn_cnt NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 동일한 JOB_ID가 있는지 체크</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">        <span class="keyword">INTO</span> vn_cnt</span><br><span class="line">    <span class="keyword">FROM</span> JOBS</span><br><span class="line">    <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 없으면 INSERT </span></span><br><span class="line">    IF vn_cnt <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span> </span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> JOBS(job_id</span><br><span class="line">                     , job_title</span><br><span class="line">                     , min_salary</span><br><span class="line">                     , max_salary</span><br><span class="line">                     , create_date</span><br><span class="line">                     , update_date) </span><br><span class="line">        <span class="keyword">VALUES</span>(p_job_id, p_job_title, p_min_sal, p_max_sal, SYSDATE, SYSDATE);</span><br><span class="line">    <span class="keyword">ELSE</span> <span class="comment">-- 있으면 UPDATE</span></span><br><span class="line">        <span class="keyword">UPDATE</span> JOBS </span><br><span class="line">            <span class="keyword">SET</span> job_title    <span class="operator">=</span> p_job_title</span><br><span class="line">            ,   min_salary   <span class="operator">=</span> p_min_sal</span><br><span class="line">            ,   max_salary   <span class="operator">=</span> p_max_sal</span><br><span class="line">            ,   update_date  <span class="operator">=</span> SYSDATE</span><br><span class="line">        <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> my_new_job_proc(<span class="string">&#x27;SM_JOB1&#x27;</span>, <span class="string">&#x27;Sample JOB1&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> jobs <span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;SM_JOB1&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- OUT, IN OUT 매개변수</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> my_new_job_proc</span><br><span class="line">(p_job_id <span class="keyword">IN</span> JOBS.JOB_ID<span class="operator">%</span>TYPE</span><br><span class="line"> , p_job_title <span class="keyword">IN</span> JOBS.JOB_TITLE<span class="operator">%</span>TYPE</span><br><span class="line"> , p_min_sal <span class="keyword">IN</span> JOBS.MIN_SALARY<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">10</span></span><br><span class="line"> , p_max_sal <span class="keyword">IN</span> JOBS.MAX_SALARY<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">100</span></span><br><span class="line"> , p_upd_date <span class="keyword">OUT</span> JOBS.UPDATE_DATE<span class="operator">%</span>TYPE <span class="comment">-- 갱신일자 값을 반환한다! </span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">    vn_cnt NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    vn_cur_date JOBS.UPDATE_DATE<span class="operator">%</span>TYPE :<span class="operator">=</span> SYSDATE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 동일한 JOB_ID가 있는지 체크</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">        <span class="keyword">INTO</span> vn_cnt</span><br><span class="line">    <span class="keyword">FROM</span> JOBS</span><br><span class="line">    <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 없으면 INSERT </span></span><br><span class="line">    IF vn_cnt <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span> </span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> JOBS(job_id</span><br><span class="line">                     , job_title</span><br><span class="line">                     , min_salary</span><br><span class="line">                     , max_salary</span><br><span class="line">                     , create_date</span><br><span class="line">                     , update_date) </span><br><span class="line">        <span class="keyword">VALUES</span>(p_job_id, p_job_title, p_min_sal, p_max_sal, SYSDATE, SYSDATE);</span><br><span class="line">    <span class="keyword">ELSE</span> <span class="comment">-- 있으면 UPDATE</span></span><br><span class="line">        <span class="keyword">UPDATE</span> JOBS </span><br><span class="line">            <span class="keyword">SET</span> job_title    <span class="operator">=</span> p_job_title</span><br><span class="line">            ,   min_salary   <span class="operator">=</span> p_min_sal</span><br><span class="line">            ,   max_salary   <span class="operator">=</span> p_max_sal</span><br><span class="line">            ,   update_date  <span class="operator">=</span> SYSDATE</span><br><span class="line">        <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- OUT, IN OUT 매개변수</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> my_new_job_proc</span><br><span class="line">(p_job_id <span class="keyword">IN</span> JOBS.JOB_ID<span class="operator">%</span>TYPE</span><br><span class="line"> , p_job_title <span class="keyword">IN</span> JOBS.JOB_TITLE<span class="operator">%</span>TYPE</span><br><span class="line"> , p_min_sal <span class="keyword">IN</span> JOBS.MIN_SALARY<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">10</span></span><br><span class="line"> , p_max_sal <span class="keyword">IN</span> JOBS.MAX_SALARY<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">100</span></span><br><span class="line"> , p_upd_date <span class="keyword">OUT</span> JOBS.UPDATE_DATE<span class="operator">%</span>TYPE <span class="comment">-- 갱신일자 값을 반환한다! </span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">    vn_cnt NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    vn_cur_date JOBS.UPDATE_DATE<span class="operator">%</span>TYPE :<span class="operator">=</span> SYSDATE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 동일한 JOB_ID가 있는지 체크</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">        <span class="keyword">INTO</span> vn_cnt</span><br><span class="line">    <span class="keyword">FROM</span> JOBS</span><br><span class="line">    <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 없으면 INSERT </span></span><br><span class="line">    IF vn_cnt <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span> </span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> JOBS(job_id</span><br><span class="line">                     , job_title</span><br><span class="line">                     , min_salary</span><br><span class="line">                     , max_salary</span><br><span class="line">                     , create_date</span><br><span class="line">                     , update_date) </span><br><span class="line">        <span class="keyword">VALUES</span>(p_job_id, p_job_title, p_min_sal, p_max_sal, vn_cur_date, vn_cur_date);</span><br><span class="line">    <span class="keyword">ELSE</span> <span class="comment">-- 있으면 UPDATE</span></span><br><span class="line">        <span class="keyword">UPDATE</span> JOBS </span><br><span class="line">            <span class="keyword">SET</span> job_title    <span class="operator">=</span> p_job_title</span><br><span class="line">            ,   min_salary   <span class="operator">=</span> p_min_sal</span><br><span class="line">            ,   max_salary   <span class="operator">=</span> p_max_sal</span><br><span class="line">            ,   update_date  <span class="operator">=</span> vn_cur_date</span><br><span class="line">        <span class="keyword">WHERE</span> job_id <span class="operator">=</span> p_job_id;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- OUT 매개변수에 갱신 일자 할당</span></span><br><span class="line">    p_upd_date :<span class="operator">=</span> vn_cur_date;</span><br><span class="line">    <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> SERVEROUTPUT <span class="keyword">ON</span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vd_cur_date JOBS.UPDATE_DATE<span class="operator">%</span>TYPE; </span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    my_new_job_proc(<span class="string">&#x27;SM_JOB1&#x27;</span>, <span class="string">&#x27;Sample JOB1&#x27;</span>, <span class="number">2000</span>, <span class="number">6000</span>, vd_cur_date);</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vd_cur_date);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-20T00:00:00.000Z" title="2022. 5. 20. 오전 9:00:00">2022-05-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-28T02:06:16.130Z" title="2022. 5. 28. 오전 11:06:16">2022-05-28</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/PL-SQL/">PL/SQL</a></span><span class="level-item">5 minutes read (About 801 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/20/PL_SQL_practice_1/">PL/SQL practice01</a></h1><div class="content"><ul>
<li>PL&#x2F;SQL은 일반 프로그래밍 언어에서 제공하는 많은 기능이 탑재되어 있다.</li>
<li>다른 프로그래밍 언어와 다른 점은 PL&#x2F;SQL은 DB에 직접 탑재되어 컴파일되고 실행되어 성능 면에서도 우수하고, DB 관련 처리를 할 때 수많은 기능을 제공한다</li>
</ul>
<h3 id="IF문"><a href="#IF문" class="headerlink" title="IF문"></a>IF문</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- IF문</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> SERVEROUTPUT <span class="keyword">ON</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    vn_num1 NUMBER :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    vn_num2 NUMBER :<span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    IF vn_num1 <span class="operator">&gt;=</span> vn_num2 <span class="keyword">THEN</span></span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(vn_num1 <span class="operator">||</span> <span class="string">&#x27;이 큰 수&#x27;</span>);</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(vn_num2 <span class="operator">||</span> <span class="string">&#x27;이 큰 수&#x27;</span>);</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/PL_SQL_practice_1/Untitled.png" alt="Untitled"></p>
<h3 id="ELSE-IF문"><a href="#ELSE-IF문" class="headerlink" title="ELSE IF문"></a>ELSE IF문</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_salary NUMBER :<span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- 변수 초기화 </span></span><br><span class="line">    vn_department_id NUMBER :<span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- 변수 초기화 </span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    vn_department_id :<span class="operator">=</span> ROUND(DBMS_RANDOM.VALUE (<span class="number">10</span>, <span class="number">120</span>), <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">SELECT</span> salary </span><br><span class="line">        <span class="keyword">INTO</span> vn_salary</span><br><span class="line">    <span class="keyword">FROM</span> employees</span><br><span class="line">    <span class="keyword">WHERE</span> department_id <span class="operator">=</span> vn_department_id</span><br><span class="line">        <span class="keyword">AND</span> ROWNUM <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vn_salary);</span><br><span class="line">    </span><br><span class="line">    IF vn_salary <span class="keyword">BETWEEN</span> <span class="number">1</span> <span class="keyword">AND</span> <span class="number">3000</span> <span class="keyword">THEN</span> </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;낮음&#x27;</span>);</span><br><span class="line">    ELSIF vn_salary <span class="keyword">BETWEEN</span> <span class="number">3001</span> <span class="keyword">AND</span> <span class="number">6000</span> <span class="keyword">THEN</span> </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;중간&#x27;</span>);</span><br><span class="line">    ELSIF vn_salary <span class="keyword">BETWEEN</span> <span class="number">6001</span> <span class="keyword">AND</span> <span class="number">10000</span> <span class="keyword">THEN</span> </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;높음&#x27;</span>);</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;최상위&#x27;</span>);</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="중첩-IF문"><a href="#중첩-IF문" class="headerlink" title="중첩 IF문"></a>중첩 IF문</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 중첩 IF문</span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_salary NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    vn_department_id NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    vn_commission NUMBER :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    vn_department_id :<span class="operator">=</span> ROUND(DBMS_RANDOM.VALUE (<span class="number">10</span>,<span class="number">120</span>), <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">SELECT</span> salary, commission_pct</span><br><span class="line">        <span class="keyword">INTO</span> vn_salary, vn_commission</span><br><span class="line">    <span class="keyword">FROM</span> employees</span><br><span class="line">    <span class="keyword">WHERE</span> department_id <span class="operator">=</span> vn_department_id</span><br><span class="line">        <span class="keyword">AND</span> ROWNUM <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vn_salary);</span><br><span class="line">    </span><br><span class="line">    IF vn_commission <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span> </span><br><span class="line">        IF vn_commission <span class="operator">&gt;</span> <span class="number">0.15</span> <span class="keyword">THEN</span> </span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(vn_salary <span class="operator">*</span> vn_commission);</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(vn_salary);</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="CASE"><a href="#CASE" class="headerlink" title="CASE"></a>CASE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CASE (p.277)</span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_salary NUMBER :<span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- 변수 초기화 </span></span><br><span class="line">    vn_department_id NUMBER :<span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- 변수 초기화 </span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    vn_department_id :<span class="operator">=</span> ROUND(DBMS_RANDOM.VALUE (<span class="number">10</span>, <span class="number">120</span>), <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">SELECT</span> salary </span><br><span class="line">        <span class="keyword">INTO</span> vn_salary</span><br><span class="line">    <span class="keyword">FROM</span> employees</span><br><span class="line">    <span class="keyword">WHERE</span> department_id <span class="operator">=</span> vn_department_id</span><br><span class="line">        <span class="keyword">AND</span> ROWNUM <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vn_salary);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">CASE</span> <span class="keyword">WHEN</span> vn_salary <span class="keyword">BETWEEN</span> <span class="number">1</span> <span class="keyword">AND</span> <span class="number">3000</span> <span class="keyword">THEN</span> </span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;낮음&#x27;</span>);</span><br><span class="line">        <span class="keyword">WHEN</span> vn_salary <span class="keyword">BETWEEN</span> <span class="number">3001</span> <span class="keyword">AND</span> <span class="number">6000</span> <span class="keyword">THEN</span> </span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;낮음&#x27;</span>);</span><br><span class="line">        <span class="keyword">WHEN</span> vn_salary <span class="keyword">BETWEEN</span> <span class="number">6001</span> <span class="keyword">AND</span> <span class="number">10000</span> <span class="keyword">THEN</span> </span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;높음&#x27;</span>);</span><br><span class="line">        <span class="keyword">ELSE</span></span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;최상위&#x27;</span>);</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="LOOP-문"><a href="#LOOP-문" class="headerlink" title="LOOP 문"></a>LOOP 문</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- LOOP</span></span><br><span class="line"><span class="comment">-- 3단</span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_base_num NUMBER :<span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    vn_cnt      NUMBER :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    LOOP</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> vn_cnt <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> </span><br><span class="line">                             <span class="operator">||</span> vn_base_num <span class="operator">*</span> vn_cnt);</span><br><span class="line">        vn_cnt :<span class="operator">=</span> vn_cnt <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        EXIT <span class="keyword">WHEN</span> vn_cnt <span class="operator">&gt;</span> <span class="number">9</span>; <span class="comment">-- vn_cnt가 9보다 크면 루프 종료</span></span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="WHILE-문"><a href="#WHILE-문" class="headerlink" title="WHILE 문"></a>WHILE 문</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- WHILE </span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_base_num NUMBER :<span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    vn_cnt      NUMBER :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">-- 조건식이 참일 때만 실행되는 것</span></span><br><span class="line"><span class="comment">-- 조건식이 거짓이 되면 실행 중지</span></span><br><span class="line">WHILE vn_cnt <span class="operator">&lt;=</span> <span class="number">9</span> <span class="comment">-- vn_cnt가 9보다 크면 루프 종료</span></span><br><span class="line">    LOOP</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> vn_cnt <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> </span><br><span class="line">                             <span class="operator">||</span> vn_base_num <span class="operator">*</span> vn_cnt);</span><br><span class="line">        vn_cnt :<span class="operator">=</span> vn_cnt <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="WHILE-EXIT"><a href="#WHILE-EXIT" class="headerlink" title="WHILE (EXIT)"></a>WHILE (EXIT)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- WHILE (EXIT)</span></span><br><span class="line"><span class="comment">-- WHILE </span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_base_num NUMBER :<span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    vn_cnt      NUMBER :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">-- 조건식이 참일 때만 실행되는 것</span></span><br><span class="line"><span class="comment">-- 조건식이 거짓이 되면 실행 중지</span></span><br><span class="line">WHILE vn_cnt <span class="operator">&lt;=</span> <span class="number">9</span> <span class="comment">-- vn_cnt가 9보다 크면 루프 종료</span></span><br><span class="line">    LOOP</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> vn_cnt <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> </span><br><span class="line">                             <span class="operator">||</span> vn_base_num <span class="operator">*</span> vn_cnt);</span><br><span class="line">                             </span><br><span class="line">        <span class="comment">-- Break (= EXIT)</span></span><br><span class="line">        EXIT <span class="keyword">WHEN</span> vn_cnt <span class="operator">=</span> <span class="number">5</span>; <span class="comment">-- vn_cnt값이 5가 되면 루프 종료</span></span><br><span class="line">        vn_cnt :<span class="operator">=</span> vn_cnt <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="FOR-LOOP"><a href="#FOR-LOOP" class="headerlink" title="FOR-LOOP"></a>FOR-LOOP</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- FOR-LOOP </span></span><br><span class="line"><span class="comment">-- 인덱스값</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    vn_base_num NUMBER :<span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.9</span></span><br><span class="line">    LOOP </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE (vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> i <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> <span class="operator">||</span> vn_base_num <span class="operator">*</span> i);</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="CONTINUE"><a href="#CONTINUE" class="headerlink" title="CONTINUE"></a>CONTINUE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CONTINUE</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    vn_base_num NUMBER :<span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.9</span></span><br><span class="line">    LOOP</span><br><span class="line">        CONTINUE <span class="keyword">WHEN</span> i <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE (vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> i <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> <span class="operator">||</span> vn_base_num <span class="operator">*</span> i);</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="GOTO-문"><a href="#GOTO-문" class="headerlink" title="GOTO 문"></a>GOTO 문</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- GOTO문</span></span><br><span class="line"><span class="comment">-- 사용자 정의 함수와 약간 비슷</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    vn_base_num NUMBER :<span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    <span class="operator">&lt;&lt;</span>third<span class="operator">&gt;&gt;</span></span><br><span class="line">    <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.9</span></span><br><span class="line">    LOOP</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE (vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> i <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> <span class="operator">||</span> vn_base_num <span class="operator">*</span> i);</span><br><span class="line">        IF i <span class="operator">=</span> <span class="number">3</span> <span class="keyword">THEN</span></span><br><span class="line">            GOTO fourth;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line">    </span><br><span class="line">    <span class="operator">&lt;&lt;</span>fourth<span class="operator">&gt;&gt;</span></span><br><span class="line">    vn_base_num :<span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.9</span></span><br><span class="line">    LOOP</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE (vn_base_num <span class="operator">||</span> <span class="string">&#x27;*&#x27;</span> <span class="operator">||</span> i <span class="operator">||</span> <span class="string">&#x27;= &#x27;</span> <span class="operator">||</span> vn_base_num <span class="operator">*</span> i);</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- NULL문</span></span><br><span class="line"><span class="comment">-- 검색 찾기 링크 참조</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-19T00:00:00.000Z" title="2022. 5. 19. 오전 9:00:00">2022-05-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-24T12:31:45.470Z" title="2022. 5. 24. 오후 9:31:45">2022-05-24</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/PL-SQL/">PL/SQL</a></span><span class="level-item">11 minutes read (About 1576 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/19/PL_SQL_start/">PL/SQL start</a></h1><div class="content"><h3 id="PL-x2F-SQL"><a href="#PL-x2F-SQL" class="headerlink" title="PL&#x2F;SQL"></a>PL&#x2F;SQL</h3><ul>
<li>SQL은 비절차적 언어<ul>
<li>파이썬, R, 자바 등과는 다르다</li>
</ul>
</li>
<li>‘DB 프로그래밍’이라 하면 SQL을 사용한 DML문을 사용하는 것을 지칭할 수도 있지만, 실제 복잡한 비즈니스 로직을 만드는 것은 PL&#x2F;SQL을 사용해 구현하는 것이 보통이다.</li>
<li>PL&#x2F;SQL은 일반 프로그래밍 언어에서 제공하는 많은 기능이 탑재되어 있다.</li>
<li>다른 프로그래밍 언어와 다른 점은 PL&#x2F;SQL은 DB에 직접 탑재되어 컴파일되고 실행되어 성능 면에서도 우수하고, DB 관련 처리를 할 때 수많은 기능을 제공한다.</li>
</ul>
<p>둘째 마당 </p>
<ul>
<li>복잡한 비즈니스 로직을 처리하는 —&gt; 프로그래밍</li>
</ul>
<h3 id="PL-x2F-SQL-기본-구조"><a href="#PL-x2F-SQL-기본-구조" class="headerlink" title="PL&#x2F;SQL 기본 구조"></a>PL&#x2F;SQL 기본 구조</h3><ul>
<li><p>PL&#x2F;SQL 소스 프로그램의 기본 단위를 <strong>블록</strong>(Block)이라고 하는데, 블록은 선언부, 실행부, 예외 처리부로 구성된다.</p>
</li>
<li><p>이 블록은 다시 이름이 없는 블록과 이름이 있는 블록으로 구분할 수 있는데 전자에 속하는 것이 익명 블록이며, 함수, 프로시저, 패키지 등이 후자에 속한다.</p>
</li>
<li><p>오라클 SQL과 PL&#x2F;SQL을 다루는 기술 260p</p>
</li>
<li><p>이름이 없는 익명 블록anonymous block을 사용해 PL&#x2F;SQL 코드를 작성해 보자.</p>
</li>
<li><p>먼저 변수를 선언하고 값을 할당해 이 값을 출력하는 익명 블록을 만든다.</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- PL/SQL</span></span><br><span class="line"><span class="comment">-- 블록 단위로 진행</span></span><br><span class="line"><span class="comment">-- 선언부</span></span><br><span class="line"><span class="keyword">SET</span> SERVEROUTPUT <span class="keyword">ON</span></span><br><span class="line"><span class="keyword">SET</span> TIMING <span class="keyword">ON</span>       <span class="comment">-- 경과시간 확인</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    vi_num NUMBER;  <span class="comment">-- 변수 선언</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- 실행 (코드 실행)</span></span><br><span class="line">    vi_num :<span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vi_num);</span><br><span class="line"><span class="keyword">END</span>; <span class="comment">-- 블록 종료</span></span><br><span class="line"><span class="comment">-- / PL/SQL 자체가 종료</span></span><br></pre></td></tr></table></figure>

<ul>
<li>만약 현재 로그온 한 SQL<em>Plus를 종료하고 다시 접속한다면 “SET SERVEROUTPUT ON”이란 명령어를 다시 실행해야 출력 결과를 볼 수 있다.</em></li>
<li><em>참고로 SQL</em>Plus 상에서 PL&#x2F;SQL 블록을 실행했을 때 총 소요시간도 알 수 있는데, 이를 위해서는 SET TIMING ON 명령어를 실행하면 된다.</li>
</ul>
<p>실행)</p>
<p><img src="/images/PL_SQL_start/Untitled.png" alt="Untitled"></p>
<h3 id="상수"><a href="#상수" class="headerlink" title="상수"></a>상수</h3><ul>
<li>상수는 변수와는 달리 한 번 값을 할당하면 변하지 않는다</li>
<li><code>상수명 CONSTANT 데이터타빙 : = 상수값;</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- p.264</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    a <span class="type">INTEGER</span> :<span class="operator">=</span> <span class="number">2</span><span class="operator">*</span><span class="operator">*</span><span class="number">2</span><span class="operator">*</span><span class="number">3</span><span class="operator">*</span><span class="operator">*</span><span class="number">2</span>; <span class="comment">-- 4 * 9</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;a = &#x27;</span> <span class="operator">||</span> TO_CHAR(a));</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/PL_SQL_start/Untitled%201.png" alt="Untitled"></p>
<h3 id="DML문"><a href="#DML문" class="headerlink" title="DML문"></a>DML문</h3><ul>
<li>SQL문 중 DDL은 PL&#x2F;SQL 상에서 직접 쓸 수 없고 DML문만 사용한다.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DM문</span></span><br><span class="line"><span class="comment">-- PL/SQL 테이블과 연동해서 특정 로직을 처리하는 것</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    vs_emp_name VARCHAR2(<span class="number">80</span>); <span class="comment">-- 사원명 변수</span></span><br><span class="line">    vs_dep_name VARCHAR2(<span class="number">80</span>); <span class="comment">-- 부원명 변수</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> a.emp_name, b.department_name</span><br><span class="line">        <span class="keyword">INTO</span> vs_emp_name, vs_dep_name</span><br><span class="line">    <span class="keyword">FROM</span> employees a</span><br><span class="line">        , departments b</span><br><span class="line">    <span class="keyword">WHERE</span> a.department_id <span class="operator">=</span> b.department_id</span><br><span class="line">        <span class="keyword">AND</span> a.employee_id <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vs_emp_name <span class="operator">||</span> <span class="string">&#x27; - &#x27;</span> <span class="operator">||</span> vs_dep_name);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/PL_SQL_start/Untitled%202.png" alt="Untitled"></p>
<h3 id="데이터-타입"><a href="#데이터-타입" class="headerlink" title="데이터 타입"></a>데이터 타입</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    vs_emp_name employees.emp_name<span class="operator">%</span>TYPE; <span class="comment">-- 사원명 변수</span></span><br><span class="line">    vs_dep_name departments.department_name<span class="operator">%</span>TYPE; <span class="comment">-- 부원명 변수</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> a.emp_name, b.department_name</span><br><span class="line">        <span class="keyword">INTO</span> vs_emp_name, vs_dep_name</span><br><span class="line">    <span class="keyword">FROM</span> employees a</span><br><span class="line">        , departments b</span><br><span class="line">    <span class="keyword">WHERE</span> a.department_id <span class="operator">=</span> b.department_id</span><br><span class="line">        <span class="keyword">AND</span> a.employee_id <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(vs_emp_name <span class="operator">||</span> <span class="string">&#x27; - &#x27;</span> <span class="operator">||</span> vs_dep_name);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/PL_SQL_start/Untitled%203.png" alt="Untitled"></p>
<h3 id="데이터-크기"><a href="#데이터-크기" class="headerlink" title="데이터 크기"></a>데이터 크기</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL과 PL/SQL에서 사용할 수 있는 데이터 크기는 다름</span></span><br><span class="line"><span class="comment">-- PL/SQL &gt; SQL보다 더 큰 크기로 사용 가능</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> ch08_varchar2;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> ch08_varchar2(</span><br><span class="line">    VAR1 VARCHAR2(<span class="number">4000</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> ch08_varchar2 (VAR1)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;tQbADHDjqtRCvosYCLwzbyKKrQCdJubDPTHnzqvjRwGxhQJtrVbXsLNlgeeMCemGMYpvfoHUHDxIPTDjleABGoowxlzCVipeVwsMFRNzZYgHfQUSIeOITaCKJpxAWwydApVUlQiKDgJlFIOGPOKoJsoemqNbOLdZOBcQhDcMLXuYjRQZDIpgpmImgiwzcLkSilCmLrSbmFNsKEEpzCHDylMvkYPKPNeuJxLvJiApNCYzrMcflECbxwNTKSxaEwVvCYnTnFfMFgDqxobWcSmMJrNTQIVOeWlPaMTfRHsrlFSukppmljmOojPSgJiSbQcgtWWOwUNNYFGtgCGBsIcTGAiHWBxtYVXecoJgJCAJptIVmVTZSKliRLoPYTIUpksBuQaqFHLhCkosWChoMjbqgLtBIRBynsKjKiLrdeHVvZanNVElDjLWwlCDhbpsAVQMTzjzhoKIJBdthynMBMVjeNmsKAjdAYhPZKmuKOuMloQdkqPjoKbfjDEeATciMrXiMQorMhYmBlMODBbyLLIkbmtZdPcWGSuxFEUwXnWpvnunEgcLelSneRIpgRNTzTkHqgLbpxoHzCYgSWlIAvKljCnmWiPWGGwlUFOudRSdoqUxntyhNYEiVXtMObywEltTImawnElpmeiWwlTjGTFceqyjhNqiDLxwduubykWzDmFSJNvVvDZibrCpAReqQjlQZcxuVqjKGKvoDuEcQPQeDzmdMYSOTIQdPDNfDffCOUWflHSQhvVTiYumBQIoyznWNITGZkefknJpGEutUnhBgLPQTWTBeTYccqlLrxvRjfJpdpfVDqqfKCngemIEDDHNdvBxCqKDTrrJAumXMKgpWLIHctQuACeNaKnffpYXiioLxZDrxpuZPPUGpRsCtoQuBfogkKuusVATkMyajKTPSyTQbfhZepRjNdrhkymqKvsAcThYbMSMnkKcLWFPAMeGysBVKkQtFMPvRBoDszlSZcMYzwxkKQwJnuVnDxShYiHFlzgDWqhZoqeypyFVBNDtHkiVzHkQisYLbsbVneJyHbHdtaIFLVbfTqbkGQTEjFlPiGUddPUIoLWALrbKcLwBizwhJvaXkvOphcGWpdNAhxgehCvjcQFSFhxrBuANKjyWncWAUpKKJcfQCsQlLfpqdMhjWGkAMMWUaDfCrGtmtkiIZOdNapEnvfFKiHAhBhejgKSuyKXFQXyCaLwwvonHsceJKgjtnYVZvBCYYBSqNCqVqCGewootJJsqrCnmiteMZBbyMPnIrdcielnGUYmwiOPmEqKGvxDmDRTDRumnSRcnvgxLbaiQIuzdslEIMquvvwmvgaumqPkduNyfRtXErCPvDYLelhjNNOjbGryRpTtDHxIJebMEtKryUyZRIdADeTEBExwHMRHzAYFizYiesaMhNIsOUzUTmyEMuFQrsUEtjwhUWIvADNlrcxPZwRazPMMvdVZssmXbXuCkRoPYNGLPwUmrWrrIgQoMSGMPvTcbHnbtleyKYmOMgymANQBZDMoqAOzMHrAVunIiykCudFVNObNgXOoyfQRICbFsWygSZXufipvrWWmRnBWYdoKmIRewOObUjiNDdQsxQIXtlbPSSngfQPfeQKOolVASXIuAmeODKtSOPaEaFKcedGzzsbrPlsPnRRuYFeVdhyufpjFVVrTPczSQkmPYXercLMmVEaDmJXKTqEVNSKeOshDCDJwdINFsLhAuKIIfOdjSEndDwumQLvePVjzNoIfUELOANeshoNgwVhFADjtUIjIhQAIyRnzSoxSRSWklITMgdjQZTthwsnBVLWyfSsAdLzOnEqmMCGBlTYGjtqvKbBoATRwkPkOTSbUhZClVzjiLLIFEMuptuodeRKXUaBfUhVTtasFsZdVnKtEfLldJYsxjlrBADRqhEBEmBKxlXKgEhiKcwAdztcETMUteJwadfaZLEBRjwJOGaIMhsfAxtuBQWyQLGXPDlFQmkcMsKsGUlQBEAubDqbuBYqXLZgmhPftLkYaCYGReLCVXssOxzJFJwnxKJzaaYzfVpbHYBtiBeQZRilJZqrrMTrVtYAcwGxAAddwtlxzdZebfZHjzqRmrrBPNbkVHqjCHtVKUjIDPVSrtyEsPRPoyyPOFOSBcgClTzlAIPmPMkdlpFHctzKGpyQMInMwPKojVErCOrHbCsZoEXqyOcHReSybmxwYabyioVnDxPEvskutVHLWQTNudmKICoaoSGKqONrBmvtGNBKAaJxCRKTDOIqrJOsQVOmGxmuIDEddVYvDwILTyushOAiXbkRIKgNLnFJdOagmiOHKRBKIIkxkOUeZWMRNlqpJdFgKjrGhIzrgBtgjVOtZAskKRbqzRVwLUoUAtRpRkoRQNLIrbLmmjZTugXJBNCscnMguKVAFDKpODtCsmdlBvQGALeBGUitYBxLYhJxeVcAnTWmTAvCITzdzqiBfEudEIBmkDAXIFmoOmsTMZDOnhXYrgMDlDbjednYWWJbGhrXFrxMQmQSmRBwoOqWGbGmjZNlJCvSHvmtZUkIScWXVdfSsdvdyQNpGFIOuteXhCMLmmEHrMucEmFbCIOHTJINAuIUOPfAfijIPkZjppGCCSRJNXWNCmliwUgABkHWuelUWeLsyVKVcZWOSeiQBQibCQJQUgGkTrXZxdBLsgjeMIwOyORDBpywuvlrLScRNhvaCYaKKRvOZeqBebUWWFhNnIRJvedFNfFPgWZJgNRaUpyYWFNiXJfAqNjyCEQYwAdFBQKKolwrufmJOfrToJFEsoNjaphcNvfWGIjKrKZSoSJEsbRqNVcoprpcGrnBgcNAnWUFpRldcPJkPfaoLKRCmVyMAWMXmnScodKisCTqllZEWQQSCFETxLNntgdcFEFRsTSIhuewwrHIlOeCcRqkzgQhKnKyHZHdFsMEKvPywLbjaspVxUMEkVzCGcGoTmaBjUMwJuAYdSTaYGDHHWDrvGgMVTtehpzfgofkmqtamffJbCKOzJgPsHNEnFarjADJGyKLwwitCiBXIraUdZtZwNjUtGbWqxksepVYztIBrimByoYQfUQgOndzFmhnuSmhYWvHliWUHgbvBIkYasDElNsjcCLtMvjQEhJjWvlnAscPwOYfelrfgfRAZGBxdFlMNkfYEWLbkfUhbRPHoDZsaAQdoKhAAWzOcHoAkkHPQMNIxgHNJaqEFBqCuMYEtLpMnIiMCWWEPnBYgYrxlXFGYpQWUNFevwcEUvUzDeSZNrdmahAfjeLSAGjHVnqyTzJkiVXjDJXzOiszXQCErQwwDMMqjLxWebJwNAVdrXeyMDRYXmLMDnuWLVaShVGhlgvbjOdOnhCDTNVazYDnzstqxjOuWbLcDaavRumKUOQXBQwKtdFgOzXiQKWFporrIcylIHlTmTKAIpBqNUbkajLTlwAHieCcqPIJYhegwQhWpYZdfxpQXDKtYzsrmnvdiTKgXfXKlIHPHlxQtqXGhMVPOBAKVZJfkrDNEwnQFwgfoHJSqQxTzRswVLrtFgpVzKcLilgznElWUfhERyeUrCcFCuGJddlFHJrXsqRdUjqUwaBmJVNwjRbCFiVMOSFuNctNVzhmhUpoddsMPUFMvNIMsMjHIWYiLjhSajZqpDkMvUOUCbYKfNHGpdUeWGUtDXHDNSCEXqYrhWhvnISnjfoBMCwwptksarPImRZaRxBMjoBdlmRGlIuQZDzCLnxxioATnGVFFTATUpeypOCaCeJAvPLxEXYzlCgXvXirGSZFyZPPSCdOSHxeELRsetFrWgqPNNpwgbgBEYPOSpLWeVdqOxPaQnidyPVMmELzeJPWgNsWBdPJPjhkdGpeAYZfrBNqdbOwzbtLiWMPafjgWQNcWKqmcleWLcMJoGSAEIUyFuzElZKXonHOMDdGMtSKEFUWdfPfnDecKNhIjAKRYmkXgpPAzlKIOpViZPkZdozzAoWwDnXkfDikvkXcQaoBtzKkcRhNpJRYaGTkdnlfotsJZsLqpYaWoK&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   vs_sql_varchar2   VARCHAR2(<span class="number">4000</span>);</span><br><span class="line">   vs_plsql_varchar2 VARCHAR2(<span class="number">32767</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- ch08_varchar2 테이블의 값을 변수에 담는다. </span></span><br><span class="line">    <span class="keyword">SELECT</span> VAR1 </span><br><span class="line">        <span class="keyword">INTO</span> vs_sql_varchar2</span><br><span class="line">    <span class="keyword">FROM</span> ch08_varchar2;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">-- PL/SQL 변수에 4000 BYTE 이상 크기의 값을 넣는다. </span></span><br><span class="line">    vs_plsql_varchar2 :<span class="operator">=</span> vs_sql_varchar2 <span class="operator">||</span> <span class="string">&#x27; - &#x27;</span> <span class="operator">||</span> vs_sql_varchar2 <span class="operator">||</span> <span class="string">&#x27; - &#x27;</span> <span class="operator">||</span> vs_sql_varchar2;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">-- 각 변수 크기를 출력한다. </span></span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;SQL VARCHAR2 길이 : &#x27;</span> <span class="operator">||</span> LENGTHB(vs_sql_varchar2)); </span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;PL/SQL VARCHAR2 길이 : &#x27;</span> <span class="operator">||</span> LENGTHB(vs_plsql_varchar2)); </span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/images/PL_SQL_start/Untitled%204.png" alt="Untitled"></p>
<h3 id="두-수의-합"><a href="#두-수의-합" class="headerlink" title="두 수의 합"></a>두 수의 합</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 두 수의 합</span></span><br><span class="line">accept p_num1 prompt <span class="string">&#x27;첫번째 숫자를 입력하세요 ~ &#x27;</span></span><br><span class="line">accept p_num2 prompt <span class="string">&#x27;두번째 숫자를 입력하세요 ~ &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    v_sum number(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    v_sum :<span class="operator">=</span> <span class="operator">&amp;</span>p_num1 <span class="operator">+</span> <span class="operator">&amp;</span>p_num2;</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;TOtal : &#x27;</span> <span class="operator">||</span> v_sum);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행) 1 2</p>
<p><img src="/images/PL_SQL_start/Untitled%205.png" alt="Untitled"></p>
<h3 id="데이터-입력"><a href="#데이터-입력" class="headerlink" title="데이터 입력"></a>데이터 입력</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">table</span> emp;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">table</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DEPT</span><br><span class="line">       (DEPTNO number(<span class="number">10</span>),</span><br><span class="line">        DNAME VARCHAR2(<span class="number">14</span>),</span><br><span class="line">        LOC VARCHAR2(<span class="number">13</span>) );</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT <span class="keyword">VALUES</span> (<span class="number">20</span>, <span class="string">&#x27;RESEARCH&#x27;</span>,   <span class="string">&#x27;DALLAS&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT <span class="keyword">VALUES</span> (<span class="number">30</span>, <span class="string">&#x27;SALES&#x27;</span>,      <span class="string">&#x27;CHICAGO&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> DEPT <span class="keyword">VALUES</span> (<span class="number">40</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27;BOSTON&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> EMP (</span><br><span class="line"> EMPNO               NUMBER(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> ENAME               VARCHAR2(<span class="number">10</span>),</span><br><span class="line"> JOB                 VARCHAR2(<span class="number">9</span>),</span><br><span class="line"> MGR                 NUMBER(<span class="number">4</span>) ,</span><br><span class="line"> HIREDATE            <span class="type">DATE</span>,</span><br><span class="line"> SAL                 NUMBER(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line"> COMM                NUMBER(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line"> DEPTNO              NUMBER(<span class="number">2</span>) );</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7839</span>,<span class="string">&#x27;KING&#x27;</span>,<span class="string">&#x27;PRESIDENT&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;81-11-17&#x27;</span>,<span class="number">5000</span>,<span class="keyword">NULL</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7698</span>,<span class="string">&#x27;BLAKE&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;81-05-01&#x27;</span>,<span class="number">2850</span>,<span class="keyword">NULL</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7782</span>,<span class="string">&#x27;CLARK&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;81-05-09&#x27;</span>,<span class="number">2450</span>,<span class="keyword">NULL</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7566</span>,<span class="string">&#x27;JONES&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;81-04-01&#x27;</span>,<span class="number">2975</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7654</span>,<span class="string">&#x27;MARTIN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;81-09-10&#x27;</span>,<span class="number">1250</span>,<span class="number">1400</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7499</span>,<span class="string">&#x27;ALLEN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;81-02-11&#x27;</span>,<span class="number">1600</span>,<span class="number">300</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7844</span>,<span class="string">&#x27;TURNER&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;81-08-21&#x27;</span>,<span class="number">1500</span>,<span class="number">0</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7900</span>,<span class="string">&#x27;JAMES&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;81-12-11&#x27;</span>,<span class="number">950</span>,<span class="keyword">NULL</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7521</span>,<span class="string">&#x27;WARD&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;81-02-23&#x27;</span>,<span class="number">1250</span>,<span class="number">500</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7902</span>,<span class="string">&#x27;FORD&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>,<span class="number">7566</span>,<span class="string">&#x27;81-12-11&#x27;</span>,<span class="number">3000</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7369</span>,<span class="string">&#x27;SMITH&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7902</span>,<span class="string">&#x27;80-12-11&#x27;</span>,<span class="number">800</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7788</span>,<span class="string">&#x27;SCOTT&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>,<span class="number">7566</span>,<span class="string">&#x27;82-12-22&#x27;</span>,<span class="number">3000</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7876</span>,<span class="string">&#x27;ADAMS&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7788</span>,<span class="string">&#x27;83-01-15&#x27;</span>,<span class="number">1100</span>,<span class="keyword">NULL</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMP <span class="keyword">VALUES</span> (<span class="number">7934</span>,<span class="string">&#x27;MILLER&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7782</span>,<span class="string">&#x27;82-01-11&#x27;</span>,<span class="number">1300</span>,<span class="keyword">NULL</span>,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span>  <span class="keyword">table</span>  salgrade;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> salgrade</span><br><span class="line">( grade   number(<span class="number">10</span>),</span><br><span class="line">  losal   number(<span class="number">10</span>),</span><br><span class="line">  hisal   number(<span class="number">10</span>) );</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade  <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">700</span>,<span class="number">1200</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade  <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">1201</span>,<span class="number">1400</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade  <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">1401</span>,<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade  <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">2001</span>,<span class="number">3000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade  <span class="keyword">values</span>(<span class="number">5</span>,<span class="number">3001</span>,<span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<h3 id="조회"><a href="#조회" class="headerlink" title="조회"></a>조회</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 사원번호를 찾아라</span></span><br><span class="line"><span class="comment">-- 사원번호를 입력하면 해당 사원의 급여가 나오도록 출력하세요!</span></span><br><span class="line"><span class="comment">-- 7782</span></span><br><span class="line">ACCEPT p_empno prompt <span class="string">&#x27;사원 번호를 입력하세요 ~&#x27;</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    v_sal number(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> SAL <span class="keyword">INTO</span> v_sal</span><br><span class="line">    <span class="keyword">FROM</span> emp</span><br><span class="line">    <span class="keyword">WHERE</span> empno <span class="operator">=</span> <span class="operator">&amp;</span>p_empno;</span><br><span class="line">    </span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;월급은 &#x27;</span><span class="operator">||</span> v_sal);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행) 7893</p>
<p><img src="/images/PL_SQL_start/Untitled%206.png" alt="Untitled"></p>
<h3 id="조건절"><a href="#조건절" class="headerlink" title="조건절"></a>조건절</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 조건절 &amp; 반복문</span></span><br><span class="line"><span class="comment">-- 사원 이름을 입력합니다. 받는 급여가 고소득자인지, 중간 소득자, 저 소득자</span></span><br><span class="line"><span class="comment">-- KING, SCOTT</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line">ACCEPT p_ename prompt <span class="string">&#x27;사원 이름을 입력하세요 ~ &#x27;</span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    <span class="comment">-- 변수 선언</span></span><br><span class="line">    v_ename emp.ename<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="built_in">upper</span>(<span class="string">&#x27;&amp;p_ename&#x27;</span>);</span><br><span class="line">    v_sal emp.sal<span class="operator">%</span>TYPE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> sal <span class="keyword">into</span> v_sal</span><br><span class="line">    <span class="keyword">FROM</span> emp</span><br><span class="line">    <span class="keyword">WHERE</span> ename <span class="operator">=</span> v_ename;</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;급여 &#x27;</span> <span class="operator">||</span> v_sal);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 조건식</span></span><br><span class="line">    IF v_sal <span class="operator">&gt;=</span> <span class="number">3500</span> <span class="keyword">THEN</span> </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;고 소득자&#x27;</span>);</span><br><span class="line">    ELSIF v_sal <span class="operator">&gt;=</span> <span class="number">2000</span> <span class="keyword">THEN</span> </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;중간 소득자&#x27;</span>);</span><br><span class="line">    <span class="keyword">ELSE</span> </span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;저 소득자&#x27;</span>);</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>실행) KING</p>
<p><img src="/images/PL_SQL_start/Untitled%207.png" alt="Untitled"></p>
<h3 id="반복문"><a href="#반복문" class="headerlink" title="반복문"></a>반복문</h3><ul>
<li>구구단 예제</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 반복문 </span></span><br><span class="line"><span class="comment">-- 구구단! </span></span><br><span class="line"><span class="number">2</span> x <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">2</span> x <span class="number">1</span> </span><br><span class="line"><span class="number">2</span> x <span class="number">2</span> <span class="operator">=</span> <span class="number">4</span> <span class="operator">=</span> <span class="number">2</span> x <span class="number">2</span></span><br><span class="line"><span class="keyword">DECLARE</span> </span><br><span class="line">    v_count number(<span class="number">10</span>) :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">    LOOP</span><br><span class="line">        v_count :<span class="operator">=</span> v_count <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;2 x &#x27;</span> <span class="operator">||</span> v_count <span class="operator">||</span> <span class="string">&#x27; = &#x27;</span> <span class="operator">||</span> <span class="number">2</span> <span class="operator">*</span> v_count);</span><br><span class="line">        EXIT <span class="keyword">WHEN</span> v_count <span class="operator">=</span> <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.notion.so/PL-SQL-01-fe33528bf2df49da993d17f993fea1ca">PL&#x2F;SQL 실습01</a></p>
<p><a target="_blank" rel="noopener" href="https://www.notion.so/PL-SQL-02-60d75b5f672844c0a922e0e62a3abeb3">PL&#x2F;SQL 실습02</a></p>
<p><a target="_blank" rel="noopener" href="https://www.notion.so/PL-SQL-ML-e8d756adeecd41d38703208774006c44">PL&#x2F;SQL - ML</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-18T00:00:00.000Z" title="2022. 5. 18. 오전 9:00:00">2022-05-18</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-23T11:43:04.957Z" title="2022. 5. 23. 오후 8:43:04">2022-05-23</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/oracle/">oracle</a></span><span class="level-item">6 minutes read (About 898 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/18/Oracle_test0/">Oracle_practice</a></h1><div class="content"><h1 id="Oracle-실습-테스트"><a href="#Oracle-실습-테스트" class="headerlink" title="Oracle 실습-테스트"></a>Oracle 실습-테스트</h1><h3 id="SQL-Developer"><a href="#SQL-Developer" class="headerlink" title="SQL-Developer"></a>SQL-Developer</h3><ul>
<li>SQL - Developer 열기</li>
<li>슬랙에서 dataset 다운로드</li>
<li>SQL - Developer 에서 데이터 임포트</li>
</ul>
<h3 id="SQL-서브쿼리-연습문제"><a href="#SQL-서브쿼리-연습문제" class="headerlink" title="SQL 서브쿼리 연습문제"></a>SQL 서브쿼리 연습문제</h3><ul>
<li>문제 1.  2015년 평균 기대수명보다 높은 모든 정보를 조회하세요.</li>
<li>테이블명 : populations</li>
<li>조건식에 서브쿼리를 설정</li>
<li>메인쿼리 서브쿼리를 설정</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> populations</span><br><span class="line"><span class="keyword">WHERE</span> life_expectancy <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(life_expectancy)</span><br><span class="line">                         <span class="keyword">FROM</span> populations</span><br><span class="line">                         <span class="keyword">WHERE</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2015</span> )</span><br><span class="line">       <span class="keyword">AND</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2015</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled.png" alt="Untitled"></p>
<ul>
<li>문제 2. subquery_countries 테이블에 있는 capital과 매칭되는 cities 테이블의 정보를 조회하라<ul>
<li>조회할 컬럼명은 name, country_code, urbanarea_pop</li>
</ul>
</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    name</span><br><span class="line">    , country_code</span><br><span class="line">    , urbanarea_pop</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    cities</span><br><span class="line"><span class="keyword">WHERE</span> name <span class="keyword">IN</span></span><br><span class="line">    (<span class="keyword">SELECT</span> capital</span><br><span class="line">    <span class="keyword">FROM</span> sub_countries)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> urbanarea_pop <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%201.png" alt="Untitled"></p>
<ul>
<li>문제 3.</li>
<li>조건 1. economies 테이블에서 country code, inflation rate, unemployment rate를 조회한다.</li>
<li>조건 2. inflation rate 오름차순으로 정렬한다.</li>
<li>조건 3. subquery_countries 테이블내 gov_form 컬럼에서</li>
<li>Constitutional Monarchy 또는 <code>Republic</code>이 들어간 국가는 제외한다.</li>
<li>Select fields</li>
<li>데이터셋</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    code</span><br><span class="line">    , inflation_rate</span><br><span class="line">    , unemployment_rate</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    economics</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2015</span> </span><br><span class="line">    <span class="keyword">AND</span> code <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> code</span><br><span class="line">                     <span class="keyword">FROM</span> sub_countries</span><br><span class="line">                     <span class="keyword">WHERE</span> (gov_form<span class="operator">=</span><span class="string">&#x27;Republic&#x27;</span> <span class="keyword">OR</span> gov_form <span class="keyword">LIKE</span> <span class="string">&#x27;%Republic%&#x27;</span>)</span><br><span class="line">                     )</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> inflation_rate;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%202.png" alt="Untitled"></p>
<ul>
<li>문제 4. 2010년 각 대륙별 inflation_rate가 가장 심한 국가와 inflation_rate를 구하세요.</li>
<li>힌트 1. 아래 쿼리 실행<br><code>SELECT country_name, continent, inflation_rate FROM sub_countries INNER JOIN economics USING (code) WHERE year = 2015;</code></li>
<li>2015년 기준으로, 각 대륙별 inflation_rate가 가장 높은 나라를 추출하는 코드를 작성한다.</li>
<li>inflation_rate가 높은 순</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sc.country_name, sc.continent, ec.inflation_rate</span><br><span class="line"><span class="keyword">FROM</span> sub_countries sc</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> economics ec</span><br><span class="line">    <span class="keyword">ON</span> sc.code <span class="operator">=</span> ec.code</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2015</span></span><br><span class="line">    <span class="keyword">AND</span> inflation_rate <span class="keyword">IN</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(inflation_rate) <span class="keyword">AS</span> max_inf</span><br><span class="line">        <span class="keyword">FROM</span>(</span><br><span class="line">            <span class="keyword">SELECT</span> sc.country_name, sc.continent, ec.inflation_rate</span><br><span class="line">            <span class="keyword">FROM</span> sub_countries sc</span><br><span class="line">            <span class="keyword">INNER</span> <span class="keyword">JOIN</span> economics ec</span><br><span class="line">            <span class="comment">-- USING(code) 대신 ON 쿼리를 작성</span></span><br><span class="line">            <span class="keyword">ON</span> sc.code <span class="operator">=</span> ec.code</span><br><span class="line">            <span class="keyword">WHERE</span> <span class="keyword">year</span> <span class="operator">=</span> <span class="number">2015</span>)</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> continent</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%203.png" alt="Untitled"></p>
<h3 id="SQL-윈도우-함수-연습문제"><a href="#SQL-윈도우-함수-연습문제" class="headerlink" title="SQL 윈도우 함수 연습문제"></a>SQL 윈도우 함수 연습문제</h3><ul>
<li>문제 1. 각 행에 숫자를 1, 2, 3, …, 형태로 추가한다. (row_n 으로 표시)</li>
<li>row_n 기준으로 오름차순으로 출력</li>
<li>테이블명에 alias를 적용한다.</li>
</ul>
<p>실행)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    ROWNUM <span class="keyword">as</span> row_n</span><br><span class="line">    , sm.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> summer_medals sm;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%204.png" alt="Untitled"></p>
<ul>
<li>문제 2. 올림픽 년도를 오름차순 순번대로 작성을 한다.</li>
<li>힌트 : 서브쿼리와 윈도우 함수를 이용한다.</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">year</span>,</span><br><span class="line">    <span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">YEAR</span>) <span class="keyword">AS</span> Row_N</span><br><span class="line"><span class="keyword">FROM</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="keyword">Year</span></span><br><span class="line">    <span class="keyword">FROM</span> summer_medals</span><br><span class="line">)Years;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%205.png" alt="Untitled"></p>
<ul>
<li>문제 3.</li>
<li>(1) WITH 절 사용하여 각 운동선수들이 획득한 메달 갯수를 내림차순으로 정렬하도록 합니다.</li>
<li>(2) (1) 쿼리를 활용하여 그리고 선수들의 랭킹을 추가한다.</li>
<li>상위 5개만 추출 : OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY</li>
<li>WITH AS (1번 쿼리)</li>
<li>2번 쿼리</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> medals <span class="keyword">AS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        Athlete</span><br><span class="line">        , <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> Medals</span><br><span class="line">    <span class="keyword">FROM</span> summer_medals</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> Athlete)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    medals</span><br><span class="line">    , Athlete</span><br><span class="line">    , <span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> Medals <span class="keyword">DESC</span>) <span class="keyword">AS</span> ROW_N</span><br><span class="line"><span class="keyword">FROM</span> medals</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Medals <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">OFFSET</span> <span class="number">0</span> <span class="keyword">ROWS</span> <span class="keyword">FETCH</span> NEXT <span class="number">5</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%206.png" alt="Untitled"></p>
<ul>
<li>문제 4</li>
<li>다음쿼리를 실행한다.</li>
<li>남자 69KG 역도 경기에서 매년 금메달리스트 조회하도록 합니다.<br><code>SELECT Year, Country AS champion FROM summer_medals WHERE Discipline = &#39;Weightlifting&#39; AND Event = &#39;69KG&#39; AND Gender = &#39;Men&#39; AND Medal = &#39;Gold&#39;;</code></li>
<li>기존 쿼리에서 매년 전년도 챔피언도 같이 조회하도록 합니다.</li>
<li>LAG &amp; WITH 절 사용</li>
</ul>
<p>답)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> Weightlifting_Gold <span class="keyword">AS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="comment">-- Return each year&#x27;s champions&#x27; countries</span></span><br><span class="line">        <span class="keyword">Year</span></span><br><span class="line">        , Country <span class="keyword">AS</span> champion</span><br><span class="line">    <span class="keyword">FROM</span> summer_medals</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        Discipline <span class="operator">=</span> <span class="string">&#x27;Weightlifting&#x27;</span> <span class="keyword">AND</span></span><br><span class="line">        Event <span class="operator">=</span> <span class="string">&#x27;69KG&#x27;</span> <span class="keyword">AND</span></span><br><span class="line">        GENDER <span class="operator">=</span> <span class="string">&#x27;Men&#x27;</span> <span class="keyword">AND</span></span><br><span class="line">        Medal <span class="operator">=</span> <span class="string">&#x27;Gold&#x27;</span>)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">Year</span></span><br><span class="line">    , Champion</span><br><span class="line">    , <span class="built_in">LAG</span>(Champion) <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">Year</span> <span class="keyword">ASC</span>) <span class="keyword">AS</span> Last_Champion</span><br><span class="line"><span class="keyword">FROM</span> Weightlifting_Gold</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">Year</span> <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<p>실행)</p>
<p><img src="/images/Oracle_test0/Untitled%207.png" alt="Untitled"></p>
<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-17T00:00:00.000Z" title="2022. 5. 17. 오전 9:00:00">2022-05-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-22T00:51:11.975Z" title="2022. 5. 22. 오전 9:51:11">2022-05-22</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/setting/">setting</a><span> / </span><a class="link-muted" href="/categories/setting/oracle/">oracle</a></span><span class="level-item">a minute read (About 178 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/17/db_data_import/">Data Import on SQL Developer</a></h1><div class="content"><h1 id="데이터-임포트"><a href="#데이터-임포트" class="headerlink" title="데이터 임포트"></a>데이터 임포트</h1><ul>
<li>SQL Developer 열기</li>
<li>우클릭 : 테이블 → 데이터 임포트</li>
</ul>
<p><img src="/images/db_data_import/Untitled.png" alt="Untitled"></p>
<ul>
<li>‘찾아보기’ → 임포트할 파일을 찾아서 열기</li>
</ul>
<p><img src="/images/db_data_import/Untitled%201.png" alt="Untitled"></p>
<ul>
<li>다음과 같이 설정한다.<ul>
<li>인코딩 : UTF-8</li>
</ul>
</li>
</ul>
<p><img src="/images/db_data_import/Untitled%202.png" alt="Untitled"></p>
<ul>
<li>테이블 이름을 설정한다.</li>
</ul>
<p><img src="/images/db_data_import/Untitled%203.png" alt="Untitled"></p>
<ul>
<li>그 외에는 설정을 디폴트로 두고 넘어간다.</li>
<li>완료</li>
</ul>
<p><img src="/images/db_data_import/Untitled%204.png" alt="Untitled"></p>
<ul>
<li>다음과 같이 알림창이 출력된다.</li>
</ul>
<p><img src="/images/db_data_import/Untitled%205.png" alt="Untitled"></p>
<ul>
<li>SQL문을 실행하여 정상 작동하는지 시험해본다.</li>
</ul>
<p><img src="/images/db_data_import/Untitled%206.png" alt="Untitled"></p>
<ul>
<li>정상적으로 출력되었다면 성공.</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-16T00:00:00.000Z" title="2022. 5. 16. 오전 9:00:00">2022-05-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-21T01:03:14.652Z" title="2022. 5. 21. 오전 10:03:14">2022-05-21</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/oracle/">oracle</a></span><span class="level-item">11 minutes read (About 1721 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/16/Oracle_practice0/">Oracle_practice0</a></h1><div class="content"><ul>
<li>p.205 6장 Self Check 6문제</li>
<li>p.256~257 7징 Self Check 5문제</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%load_ext sql</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sql oracle://ora_user:evan@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1521</span>/myoracle</span><br></pre></td></tr></table></figure>
<ol>
<li><p>101번 사원에 대해 아래의 결과를 산출하는 쿼리를 작성해 보자.</p>
<hr>
<h2 id="사번-사원명-job명칭-job시작일자-job종료일자-job수행부서명"><a href="#사번-사원명-job명칭-job시작일자-job종료일자-job수행부서명" class="headerlink" title=" 사번    사원명     job명칭     job시작일자     job종료일자        job수행부서명"></a> 사번    사원명     job명칭     job시작일자     job종료일자        job수행부서명</h2></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.employee_id</span><br><span class="line">    , a.emp_name</span><br><span class="line">    , d.job_title</span><br><span class="line">    , b.start_date</span><br><span class="line">    , b.end_date</span><br><span class="line">    , c.department_name</span><br><span class="line"><span class="keyword">FROM</span> employees a</span><br><span class="line">    , job_history b </span><br><span class="line">    , departments c</span><br><span class="line">    , jobs d</span><br><span class="line"><span class="keyword">WHERE</span> a.employee_id <span class="operator">=</span> b.employee_id</span><br><span class="line">    <span class="keyword">AND</span> b.department_id <span class="operator">=</span> c.department_id</span><br><span class="line">    <span class="keyword">AND</span> b.job_id        <span class="operator">=</span> d.job_id</span><br><span class="line">    <span class="keyword">AND</span> a.employee_id <span class="operator">=</span> <span class="number">101</span></span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>employee_id</th>
        <th>emp_name</th>
        <th>job_title</th>
        <th>start_date</th>
        <th>end_date</th>
        <th>department_name</th>
    </tr>
    <tr>
        <td>101</td>
        <td>Neena Kochhar</td>
        <td>Public Accountant</td>
        <td>1997-09-21 00:00:00</td>
        <td>2001-10-27 00:00:00</td>
        <td>경리부</td>
    </tr>
    <tr>
        <td>101</td>
        <td>Neena Kochhar</td>
        <td>Accounting Manager</td>
        <td>2001-10-28 00:00:00</td>
        <td>2005-03-15 00:00:00</td>
        <td>경리부</td>
    </tr>
</table>


<ol start="2">
<li>아래의 쿼리를 수행하면 오류가 발생한다. 오류의 원인은 무엇인지 설명해 보자.</li>
</ol>
<p>입력</p>
<pre><code>select a.employee_id, a.emp_name, b.job_id, b.department_id
  from employees a,
       job_history b
 where a.employee_id      = b.employee_id(+)
   and a.department_id(+) = b.department_id;답 : 외부 조인의 경우, 조인조건에서 데이터가 없는 테이블의 컬럼에만 (+)를 붙여야 한다.
따라서 위 쿼리의 경우, and a.department_id(+) 가 아닌 a.department_id = b.department_id(+)로 고쳐야 한다.3. 외부 조인을 할 때 (+)연산자를 같이 사용할 수 없는데, IN 절에 사용하는 값이 한 개이면 사용할 수 있다. 
</code></pre>
<p>그 이유는 무엇인지 설명해 보자.답 :<br>오라클은 IN 절에 포함된 값을 기준으로 OR로 변환한다.<br>예를 들어,<br>    department_id IN (10,20,30)은<br>    department_id &#x3D; 10<br>    OR department_id &#x3D; 20<br>    OR department_id &#x3D; 30 으로 바꿔 쓸 수 있다.</p>
<p>그런데 IN절에 값이 1개인 경우, 즉 department_id IN (10)일 경우 department_id&#x3D;10으로 변환할 수 있으며,<br>외부조인을 하더라도 값이 1개인 경우는 사용할 수 있다.4. 다음의 쿼리를 ANSI 문법으로 변경해 보자.</p>
<p>입력</p>
<pre><code>SELECT a.department_id, a.department_name
  FROM departments a, employees b
 WHERE a.department_id = b.department_id
   AND b.salary &gt; 3000
ORDER BY a.department_name;
</code></pre>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.department_id</span><br><span class="line">    , a.department_name</span><br><span class="line"><span class="keyword">FROM</span> departments a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> employees b</span><br><span class="line">    <span class="keyword">ON</span> (a.department_id <span class="operator">=</span> b.department_id)</span><br><span class="line"><span class="keyword">WHERE</span> b.salary <span class="operator">&gt;</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a.department_name</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>department_name</th>
    </tr>
    <tr>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>110</td>
        <td>경리부</td>
    </tr>
    <tr>
        <td>110</td>
        <td>경리부</td>
    </tr>
    <tr>
        <td>30</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>30</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>20</td>
        <td>마케팅</td>
    </tr>
    <tr>
        <td>20</td>
        <td>마케팅</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>40</td>
        <td>인사부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>10</td>
        <td>총무기획부</td>
    </tr>
    <tr>
        <td>70</td>
        <td>홍보부</td>
    </tr>
</table>


<ol start="5">
<li>다음은 연관성 있는 서브 쿼리다. 이를 연관성 없는 서브 쿼리로 변환해 보자.</li>
</ol>
<p>입력</p>
<pre><code>SELECT a.department_id, a.department_name
 FROM departments a
WHERE EXISTS ( SELECT 1
                 FROM job_history b
                WHERE a.department_id = b.department_id );
</code></pre>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.department_id, a.department_name</span><br><span class="line"><span class="keyword">FROM</span> departments a</span><br><span class="line"><span class="keyword">WHERE</span> a.department_id <span class="keyword">IN</span>(<span class="keyword">SELECT</span> department_id</span><br><span class="line">                         <span class="keyword">FROM</span> job_history)</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>department_name</th>
    </tr>
    <tr>
        <td>20</td>
        <td>마케팅</td>
    </tr>
    <tr>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>110</td>
        <td>경리부</td>
    </tr>
</table>


<ol start="6">
<li>연도별 이탈리아 최대매출액과 사원을 작성하는 쿼리를 학습했다.<br>이 쿼리를 기준으로 최대매출액 뿐만 아니라 최소매출액과 해당 사원을 조회하는 쿼리를 작성해 보자.</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    emp.years</span><br><span class="line">    , emp.employee_id</span><br><span class="line">    , emp2.emp_name</span><br><span class="line">    , emp.amount_sold</span><br><span class="line"><span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> </span><br><span class="line">          SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">as</span> years</span><br><span class="line">          , a.employee_id</span><br><span class="line">          , <span class="built_in">SUM</span>(a.amount_sold) <span class="keyword">AS</span> amount_sold</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">          sales a</span><br><span class="line">          , customers b</span><br><span class="line">          , countries c</span><br><span class="line">        <span class="keyword">WHERE</span> a.cust_id <span class="operator">=</span> b.CUST_ID</span><br><span class="line">          <span class="keyword">AND</span> b.country_id <span class="operator">=</span> c.COUNTRY_ID</span><br><span class="line">          <span class="keyword">AND</span> c.country_name <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span>     </span><br><span class="line">      <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>), a.employee_id   </span><br><span class="line">        ) emp,</span><br><span class="line">       ( <span class="keyword">SELECT</span></span><br><span class="line">            years</span><br><span class="line">            , <span class="built_in">MAX</span>(amount_sold) <span class="keyword">AS</span> max_sold</span><br><span class="line">            , <span class="built_in">MIN</span>(amount_sold) <span class="keyword">AS</span> min_sold</span><br><span class="line">          <span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> </span><br><span class="line">                    SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">as</span> years</span><br><span class="line">                    , a.employee_id</span><br><span class="line">                    , <span class="built_in">SUM</span>(a.amount_sold) <span class="keyword">AS</span> amount_sold</span><br><span class="line">                   <span class="keyword">FROM</span> </span><br><span class="line">                    sales a</span><br><span class="line">                    , customers b</span><br><span class="line">                    , countries c</span><br><span class="line">                  <span class="keyword">WHERE</span> a.cust_id <span class="operator">=</span> b.CUST_ID</span><br><span class="line">                    <span class="keyword">AND</span> b.country_id <span class="operator">=</span> c.COUNTRY_ID</span><br><span class="line">                    <span class="keyword">AND</span> c.country_name <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span>     </span><br><span class="line">                  <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>), a.employee_id    </span><br><span class="line">                    ) K</span><br><span class="line">          <span class="keyword">GROUP</span> <span class="keyword">BY</span> years</span><br><span class="line">       ) sale,</span><br><span class="line">       employees emp2</span><br><span class="line"><span class="keyword">WHERE</span> emp.years <span class="operator">=</span> sale.years</span><br><span class="line">    <span class="keyword">AND</span> (emp.amount_sold <span class="operator">=</span> sale.max_sold  <span class="keyword">OR</span> emp.amount_sold <span class="operator">=</span> sale.min_sold)</span><br><span class="line">    <span class="keyword">AND</span> emp.employee_id <span class="operator">=</span> emp2.employee_id</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> years</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>years</th>
        <th>employee_id</th>
        <th>emp_name</th>
        <th>amount_sold</th>
    </tr>
    <tr>
        <td>1998</td>
        <td>145</td>
        <td>John Russell</td>
        <td>311761.02</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>145</td>
        <td>John Russell</td>
        <td>4646.74</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>147</td>
        <td>Alberto Errazuriz</td>
        <td>193319.44</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>153</td>
        <td>Christopher Olsen</td>
        <td>142987.82</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>162</td>
        <td>Clara Vishney</td>
        <td>16259.5</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>173</td>
        <td>Sundita Kumar</td>
        <td>426018.7</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>148</td>
        <td>Gerald Cambrault</td>
        <td>1557.54</td>
    </tr>
</table>


<ul>
<li>7장1. 계층형 쿼리 응용편에서 LISTAGG 함수를 사용해 다음과 같이 로우를 컬럼으로 분리했다.</li>
</ul>
<p>입력</p>
<pre><code>SELECT department_id, LISTAGG(emp_name, &#39;,&#39;) WITHIN GROUP (ORDER BY emp_name) as empnames
  FROM employees
 WHERE department_id IS NOT NULL
 GROUP BY department_id;
 
</code></pre>
<p>LISTAGG 함수 대신 계층형 쿼리, 분석 함수를 사용해서 위 쿼리와 동일한 결과를 산출하는 쿼리를 작성해 보자.2. 다음 쿼리는 사원 테이블에서 JOB_ID가 ‘SH_CLERK’인 사원을 조회하는 쿼리다.</p>
<p>입력</p>
<pre><code>SELECT employee_id, emp_name, hire_date
  FROM employees
 WHERE job_id = &#39;SH_CLERK&#39;
ORDER By hire_date;
</code></pre>
<p> 결과</p>
<pre><code>EMPLOYEE_ID EMP_NAME             HIRE_DATE
----------- -------------------- -------------------
184         Nandita Sarchand     2004/01/27 00:00:00
192         Sarah Bell           2004/02/04 00:00:00
185         Alexis Bull          2005/02/20 00:00:00
193         Britney Everett      2005/03/03 00:00:00
188         Kelly Chung          2005/06/14 00:00:00
....
....
199         Douglas Grant        2008/01/13 00:00:00
183         Girard Geoni         2008/02/03 00:00:00
</code></pre>
<p>사원 테이블에서 퇴사일자(retire_date)는 모두 비어 있는데, 위 결과에서 사원번호가 184번인 사원의 퇴사일자는 다음으로 입사일자가 빠른 192번 사원의 입사일자라고 가정해서 다음과 같은 형태로 결과를 추출하도록 쿼리를 작성해 보자(입사일자가 가장 최근인 183번 사원의 퇴사일자는 NULL이다).</p>
<p>결과</p>
<pre><code>EMPLOYEE_ID EMP_NAME             HIRE_DATE            RETIRE_DATE
----------- -------------------- -------------------  ---------------------------
184         Nandita Sarchand     2004/01/27 00:00:00  2004/02/04 00:00:00
192         Sarah Bell           2004/02/04 00:00:00  2005/02/20 00:00:00
185         Alexis Bull          2005/02/20 00:00:00  2005/03/03 00:00:00
193         Britney Everett      2005/03/03 00:00:00  2005/06/14 00:00:00
188         Kelly Chung          2005/06/14 00:00:00  2005/08/13 00:00:00
....
....
199         Douglas Grant        2008/01/13 00:00:00  2008/02/03 00:00:00
183         Girard Geoni         2008/02/03 00:00:003. sales 테이블에는 판매 데이터, customers 테이블에는 고객정보가 있다. 2001년 12월(SALES_MONTH = ‘200112’) 판매 데이터 중 현재일자를 기준으로 고객의 나이(customers.cust_year_of_birth)를 계산해서 다음과 같이 연령대별 매출금액을 보여주는 쿼리를 작성해 보자.
</code></pre>
<p>결과</p>
<pre><code>-------------------------
연령대    매출금액
-------------------------
10대      xxxxxx
20대      ....
30대      ....
40대      ....
-------------------------4. 3번 문제를 이용해 월별로 판매금액이 가장 하위에 속하는 대륙 목록을 뽑아보자.
</code></pre>
<p>(대륙 목록은 countries 테이블의 country_region에 있으며, country_id 컬럼으로 customers 테이블과 조인을 해서 구한다).</p>
<p>결과</p>
<pre><code>---------------------------------
매출월    지역(대륙)  매출금액
---------------------------------
199801    Oceania      xxxxxx
199803    Oceania      xxxxxx
...
---------------------------------5. 5장 연습문제 5번의 정답 결과를 이용해 다음과 같이 지역별, 대출종류별, 월별 대출잔액과 지역별 파티션을 만들어 대출 종류별 대출잔액의 퍼센트(%)를 구하는 쿼리를 작성해보자.
</code></pre>
<p>결과</p>
<pre><code>------------------------------------------------------------------------------------------------
지역    대출종류        201111         201112    201210    201211   201212   203110    201311
------------------------------------------------------------------------------------------------
서울    기타대출       73996.9( 36% )
서울    주택담보대출   130105.9( 64% )
부산
...
...
--------------------------------------------------------------------------------------
</code></pre>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-15T00:00:00.000Z" title="2022. 5. 15. 오전 9:00:00">2022-05-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-20T11:37:12.116Z" title="2022. 5. 20. 오후 8:37:12">2022-05-20</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/oracle/">oracle</a></span><span class="level-item">20 minutes read (About 2978 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/15/Oracle_ch07_0429/">Oracle_practice7_2</a></h1><div class="content"><ul>
<li>분석함수 : RANK, DENSE_RANK, LAG, LEAD</li>
<li>RANK() OVER (PARTITION BY 컬럼명 ORDER BY 컬럼명)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%load_ext sql</span><br></pre></td></tr></table></figure>

<pre><code>The sql extension is already loaded. To reload it, use:
  %reload_ext sql
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sql oracle://ora_user:evan@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1521</span>/myoracle</span><br></pre></td></tr></table></figure>
<ul>
<li><p>분석 함수: 분석 함수 역시 특정 그룹별 집계를 담당하므로 집계 함수에 속한다. </p>
</li>
<li><p>PARTITION BY 절: 분석 함수로 계산될 대상 로우의 그룹(파티션)을 지정한다.</p>
</li>
<li><p>ORDER BY 절: 파티션 안에서의 순서를 지정한다.</p>
</li>
<li><p>WINDOW 절: 파티션으로 분할된 그룹에 대해서 더 상세한 그룹으로 분할할 때 사용된다. # Window 절 </p>
</li>
<li><p>ROWS: 로우 단위로 window 절을 지정한다.</p>
</li>
<li><p>RANGE: 로우가 아닌 논리적인 범위로 window 절을 지정한다.</p>
</li>
<li><p>BETWEEN~AND: window 절의 시작과 끝 지점을 명시한다.<br>         BETWEEN을 명시하지 않고 두 번째 옵션만 지정하면이 지점이 시작 지점이 되고 끝 지점은 현재 로우가 된다.</p>
</li>
<li><p>UNBOUNDED PRECEDING: 파티션으로 구분된 첫 번째 로우가 시작 지점이 된다.</p>
</li>
<li><p>UNBOUNDED FOLLOWING: 파티션으로 구분된 마지막 로우가 끝 지점이 된다.</p>
</li>
<li><p>CURRENT ROW: 시작 및 끝 지점이 현재 로우가된다.</p>
</li>
<li><p>value_expr PRECEDING: 끝 지점일 경우, 시작 지점은 value_expr PRECEDING.</p>
</li>
<li><p>value_expr FOLLOWING: 시작 지점일 경우, 끝 지점은 value_expr FOLLOWING.</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    department_id</span><br><span class="line">    , emp_name</span><br><span class="line">    , hire_date</span><br><span class="line">    , salary</span><br><span class="line">    , <span class="built_in">SUM</span>(salary) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date</span><br><span class="line">                        <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> UNBOUNDED FOLLOWING) <span class="keyword">AS</span> all_salary</span><br><span class="line">    , <span class="built_in">SUM</span>(salary) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date</span><br><span class="line">                        <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span>) <span class="keyword">AS</span> first_current_sal</span><br><span class="line">    , <span class="built_in">SUM</span>(salary) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date</span><br><span class="line">                        <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span> <span class="keyword">AND</span> UNBOUNDED FOLLOWING) <span class="keyword">AS</span> current_end_sal</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">30</span>, <span class="number">90</span>)</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>emp_name</th>
        <th>hire_date</th>
        <th>salary</th>
        <th>all_salary</th>
        <th>first_current_sal</th>
        <th>current_end_sal</th>
    </tr>
    <tr>
        <td>30</td>
        <td>Den Raphaely</td>
        <td>2002-12-07 00:00:00</td>
        <td>11000</td>
        <td>24900</td>
        <td>11000</td>
        <td>24900</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Alexander Khoo</td>
        <td>2003-05-18 00:00:00</td>
        <td>3100</td>
        <td>24900</td>
        <td>14100</td>
        <td>13900</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Sigal Tobias</td>
        <td>2005-07-24 00:00:00</td>
        <td>2800</td>
        <td>24900</td>
        <td>16900</td>
        <td>10800</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Shelli Baida</td>
        <td>2005-12-24 00:00:00</td>
        <td>2900</td>
        <td>24900</td>
        <td>19800</td>
        <td>8000</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Guy Himuro</td>
        <td>2006-11-15 00:00:00</td>
        <td>2600</td>
        <td>24900</td>
        <td>22400</td>
        <td>5100</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Karen Colmenares</td>
        <td>2007-08-10 00:00:00</td>
        <td>2500</td>
        <td>24900</td>
        <td>24900</td>
        <td>2500</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Lex De Haan</td>
        <td>2001-01-13 00:00:00</td>
        <td>17000</td>
        <td>58000</td>
        <td>17000</td>
        <td>58000</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Steven King</td>
        <td>2003-06-17 00:00:00</td>
        <td>24000</td>
        <td>58000</td>
        <td>41000</td>
        <td>41000</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Neena Kochhar</td>
        <td>2005-09-21 00:00:00</td>
        <td>17000</td>
        <td>58000</td>
        <td>58000</td>
        <td>17000</td>
    </tr>
</table>




<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    department_id</span><br><span class="line">    , emp_name</span><br><span class="line">    , hire_date</span><br><span class="line">    , salary</span><br><span class="line">    , <span class="built_in">FIRST_VALUE</span>(salary) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date</span><br><span class="line">                        <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> UNBOUNDED FOLLOWING) <span class="keyword">AS</span> all_salary</span><br><span class="line">    , <span class="built_in">FIRST_VALUE</span>(salary) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date</span><br><span class="line">                       <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span>) <span class="keyword">AS</span> first_current_sal</span><br><span class="line">    , <span class="built_in">FIRST_VALUE</span>(salary) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date</span><br><span class="line">                        <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span> <span class="keyword">AND</span> UNBOUNDED FOLLOWING) <span class="keyword">AS</span> current_end_sal</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">30</span>, <span class="number">90</span>)</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>emp_name</th>
        <th>hire_date</th>
        <th>salary</th>
        <th>all_salary</th>
        <th>first_current_sal</th>
        <th>current_end_sal</th>
    </tr>
    <tr>
        <td>30</td>
        <td>Den Raphaely</td>
        <td>2002-12-07 00:00:00</td>
        <td>11000</td>
        <td>11000</td>
        <td>11000</td>
        <td>11000</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Alexander Khoo</td>
        <td>2003-05-18 00:00:00</td>
        <td>3100</td>
        <td>11000</td>
        <td>11000</td>
        <td>3100</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Sigal Tobias</td>
        <td>2005-07-24 00:00:00</td>
        <td>2800</td>
        <td>11000</td>
        <td>11000</td>
        <td>2800</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Shelli Baida</td>
        <td>2005-12-24 00:00:00</td>
        <td>2900</td>
        <td>11000</td>
        <td>11000</td>
        <td>2900</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Guy Himuro</td>
        <td>2006-11-15 00:00:00</td>
        <td>2600</td>
        <td>11000</td>
        <td>11000</td>
        <td>2600</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Karen Colmenares</td>
        <td>2007-08-10 00:00:00</td>
        <td>2500</td>
        <td>11000</td>
        <td>11000</td>
        <td>2500</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Lex De Haan</td>
        <td>2001-01-13 00:00:00</td>
        <td>17000</td>
        <td>17000</td>
        <td>17000</td>
        <td>17000</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Steven King</td>
        <td>2003-06-17 00:00:00</td>
        <td>24000</td>
        <td>17000</td>
        <td>17000</td>
        <td>24000</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Neena Kochhar</td>
        <td>2005-09-21 00:00:00</td>
        <td>17000</td>
        <td>17000</td>
        <td>17000</td>
        <td>17000</td>
    </tr>
</table>


<ul>
<li>p.211</li>
<li>계층형 쿼리</li>
<li>핵심 포인트 : CONNECT BY 조건문 정리- 계층형 쿼리의 구문은 다음과 같다.</li>
</ul>
<p>SELECT expr1, expr2, …<br>FROM 테이블<br>WHERE 조건<br>START WITH[최상위 조건]<br>CONNECT BY [NOCYCLE][PRIOR 계층형 구조 조건];       –&gt; 구조 :  CONNECT BY PRIOR 하위 &#x3D; 상위 </p>
<ul>
<li><p>START WITH 조건</p>
<ul>
<li>계층형 구조에서 최상위 계층의 로우를 식별하는 조건을 명시한다. </li>
<li>START WITH가 시작한다는 의미이므로, 이 조건에 맞는 로우부터 시작해 계층형 구조를 풀어 나간다.</li>
</ul>
</li>
<li><p>CONNECT BY 조건</p>
<ul>
<li>계층형 구조가 어떤 식으로 연결되는지를 기술하는 부분이다.</li>
<li>부서 테이블은 parent_id에 상위 부서 정보를 갖고 있는데,<br>  이를 표현하려면 ‘CONNECT BY PRIOR department_id &#x3D; parent_id’로 기술해야 한다. </li>
<li>PRIOR는 계층형 쿼리에서만 사용할 수 있는 연산자로 ‘앞서의, 직전의’란 뜻이 있으므로,<br>  “이전 department_id &#x3D; parent_id”라고 알아두면 이해하기 쉬울 것이다. </li>
<li>또한 ‘CONNECT BY parent_id &#x3D; PRIOR department_id’처럼 PRIOR의 위치를 바꿀 수 있다.</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    department_id</span><br><span class="line">    , LPAD(<span class="string">&#x27; &#x27;</span>, <span class="number">3</span><span class="operator">*</span>(LEVEL<span class="number">-1</span>)) <span class="operator">||</span> department_name</span><br><span class="line">    , LEVEL</span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> parent_id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR department_id <span class="operator">=</span> parent_id </span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>LPAD(&#x27;&#x27;,3*(LEVEL-1))||DEPARTMENT_NAME</th>
        <th>LEVEL</th>
    </tr>
    <tr>
        <td>10</td>
        <td>총무기획부</td>
        <td>1</td>
    </tr>
    <tr>
        <td>20</td>
        <td>&nbsp;&nbsp;&nbsp;마케팅</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>&nbsp;&nbsp;&nbsp;구매/생산부</td>
        <td>2</td>
    </tr>
    <tr>
        <td>170</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;생산팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>180</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;건설팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>200</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;운영팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>210</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT 지원</td>
        <td>3</td>
    </tr>
    <tr>
        <td>220</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOC</td>
        <td>3</td>
    </tr>
    <tr>
        <td>40</td>
        <td>&nbsp;&nbsp;&nbsp;인사부</td>
        <td>2</td>
    </tr>
    <tr>
        <td>260</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;채용팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>50</td>
        <td>&nbsp;&nbsp;&nbsp;배송부</td>
        <td>2</td>
    </tr>
    <tr>
        <td>80</td>
        <td>&nbsp;&nbsp;&nbsp;영업부</td>
        <td>2</td>
    </tr>
    <tr>
        <td>190</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;계약팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>240</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;공공 판매사업팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>250</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;판매팀</td>
        <td>3</td>
    </tr>
    <tr>
        <td>90</td>
        <td>&nbsp;&nbsp;&nbsp;기획부</td>
        <td>2</td>
    </tr>
    <tr>
        <td>60</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT</td>
        <td>3</td>
    </tr>
    <tr>
        <td>230</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT 헬프데스크</td>
        <td>4</td>
    </tr>
    <tr>
        <td>70</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;홍보부</td>
        <td>3</td>
    </tr>
    <tr>
        <td>100</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;자금부</td>
        <td>3</td>
    </tr>
    <tr>
        <td>130</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;세무팀</td>
        <td>4</td>
    </tr>
    <tr>
        <td>140</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;신용관리팀</td>
        <td>4</td>
    </tr>
    <tr>
        <td>150</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;주식관리팀</td>
        <td>4</td>
    </tr>
    <tr>
        <td>160</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;수익관리팀</td>
        <td>4</td>
    </tr>
    <tr>
        <td>110</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;경리부</td>
        <td>3</td>
    </tr>
    <tr>
        <td>120</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;재무팀</td>
        <td>4</td>
    </tr>
    <tr>
        <td>270</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;급여팀</td>
        <td>4</td>
    </tr>
</table>


<ul>
<li>manager_id는 해당 사원의 매니저 사번이 있다.</li>
<li>각 매니저는 사원 ID가 있다.</li>
<li>사원별 계층 구조를 만들고, 부서 테이블과 조인해서 부서명까지 조회한다.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.employee_id</span><br><span class="line">    , LPAD(<span class="string">&#x27; &#x27;</span>, <span class="number">3</span> <span class="operator">*</span> (LEVEL <span class="operator">-</span> <span class="number">1</span>)) <span class="operator">||</span> a.emp_name</span><br><span class="line">    , LEVEL</span><br><span class="line">    , b.department_name</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    employees a</span><br><span class="line">    , departments b</span><br><span class="line"><span class="keyword">WHERE</span> a.department_id <span class="operator">=</span> b.department_id</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> a.manager_id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR a.employee_id <span class="operator">=</span> a.manager_id</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>employee_id</th>
        <th>LPAD(&#x27;&#x27;,3*(LEVEL-1))||A.EMP_NAME</th>
        <th>LEVEL</th>
        <th>department_name</th>
    </tr>
    <tr>
        <td>100</td>
        <td>Steven King</td>
        <td>1</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>101</td>
        <td>&nbsp;&nbsp;&nbsp;Neena Kochhar</td>
        <td>2</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>108</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nancy Greenberg</td>
        <td>3</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>109</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Daniel Faviet</td>
        <td>4</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>110</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;John Chen</td>
        <td>4</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>111</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ismael Sciarra</td>
        <td>4</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>112</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jose Manuel Urman</td>
        <td>4</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>113</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Luis Popp</td>
        <td>4</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>200</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jennifer Whalen</td>
        <td>3</td>
        <td>총무기획부</td>
    </tr>
    <tr>
        <td>203</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Susan Mavris</td>
        <td>3</td>
        <td>인사부</td>
    </tr>
    <tr>
        <td>204</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hermann Baer</td>
        <td>3</td>
        <td>홍보부</td>
    </tr>
    <tr>
        <td>205</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shelley Higgins</td>
        <td>3</td>
        <td>경리부</td>
    </tr>
    <tr>
        <td>206</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;William Gietz</td>
        <td>4</td>
        <td>경리부</td>
    </tr>
    <tr>
        <td>102</td>
        <td>&nbsp;&nbsp;&nbsp;Lex De Haan</td>
        <td>2</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>103</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alexander Hunold</td>
        <td>3</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>104</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bruce Ernst</td>
        <td>4</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>105</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;David Austin</td>
        <td>4</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>106</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Valli Pataballa</td>
        <td>4</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>107</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Diana Lorentz</td>
        <td>4</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>114</td>
        <td>&nbsp;&nbsp;&nbsp;Den Raphaely</td>
        <td>2</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>115</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alexander Khoo</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>116</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shelli Baida</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>117</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sigal Tobias</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>118</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Guy Himuro</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>119</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Karen Colmenares</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>120</td>
        <td>&nbsp;&nbsp;&nbsp;Matthew Weiss</td>
        <td>2</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>125</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Julia Nayer</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>126</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Irene Mikkilineni</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>127</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;James Landry</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>128</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Steven Markle</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>180</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Winston Taylor</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>181</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jean Fleaur</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>182</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Martha Sullivan</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>183</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Girard Geoni</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>121</td>
        <td>&nbsp;&nbsp;&nbsp;Adam Fripp</td>
        <td>2</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>129</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laura Bissot</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>130</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mozhe Atkinson</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>131</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;James Marlow</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>132</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TJ Olson</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>184</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nandita Sarchand</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>185</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alexis Bull</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>186</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Julia Dellinger</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>187</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Anthony Cabrio</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>122</td>
        <td>&nbsp;&nbsp;&nbsp;Payam Kaufling</td>
        <td>2</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>133</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jason Mallin</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>134</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Michael Rogers</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>135</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ki Gee</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>136</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hazel Philtanker</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>188</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kelly Chung</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>189</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jennifer Dilly</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>190</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Timothy Gates</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>191</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Randall Perkins</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>123</td>
        <td>&nbsp;&nbsp;&nbsp;Shanta Vollman</td>
        <td>2</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>137</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Renske Ladwig</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>138</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stephen Stiles</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>139</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;John Seo</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>140</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Joshua Patel</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>192</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sarah Bell</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>193</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Britney Everett</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>194</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Samuel McCain</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>195</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vance Jones</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>124</td>
        <td>&nbsp;&nbsp;&nbsp;Kevin Mourgos</td>
        <td>2</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>141</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Trenna Rajs</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>142</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Curtis Davies</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>143</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Randall Matos</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>144</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Peter Vargas</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>196</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alana Walsh</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>197</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kevin Feeney</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>198</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Donald OConnell</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>199</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Douglas Grant</td>
        <td>3</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>145</td>
        <td>&nbsp;&nbsp;&nbsp;John Russell</td>
        <td>2</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>150</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Peter Tucker</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>151</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;David Bernstein</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>152</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Peter Hall</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>153</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Christopher Olsen</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>154</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nanette Cambrault</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>155</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oliver Tuvault</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>146</td>
        <td>&nbsp;&nbsp;&nbsp;Karen Partners</td>
        <td>2</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>156</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Janette King</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>157</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Patrick Sully</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>158</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Allan McEwen</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>159</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lindsey Smith</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>160</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Louise Doran</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>161</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sarath Sewall</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>147</td>
        <td>&nbsp;&nbsp;&nbsp;Alberto Errazuriz</td>
        <td>2</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>162</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clara Vishney</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>163</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Danielle Greene</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>164</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mattea Marvins</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>165</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;David Lee</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>166</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sundar Ande</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>167</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Amit Banda</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>148</td>
        <td>&nbsp;&nbsp;&nbsp;Gerald Cambrault</td>
        <td>2</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>168</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lisa Ozer</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>169</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Harrison Bloom</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>170</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tayler Fox</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>171</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;William Smith</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>172</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Elizabeth Bates</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>173</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sundita Kumar</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>149</td>
        <td>&nbsp;&nbsp;&nbsp;Eleni Zlotkey</td>
        <td>2</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>174</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ellen Abel</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>175</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alyssa Hutton</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>176</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jonathon Taylor</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>177</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jack Livingston</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>179</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Charles Johnson</td>
        <td>3</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>201</td>
        <td>&nbsp;&nbsp;&nbsp;Michael Hartstein</td>
        <td>2</td>
        <td>마케팅</td>
    </tr>
    <tr>
        <td>202</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pat Fay</td>
        <td>3</td>
        <td>마케팅</td>
    </tr>
</table>


<ul>
<li>CONNECT BY ~ AND : AND를 통해 추가로 조건을 붙인다.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.employee_id</span><br><span class="line">    , LPAD(<span class="string">&#x27; &#x27;</span>, <span class="number">3</span> <span class="operator">*</span> (LEVEL <span class="operator">-</span> <span class="number">1</span>)) <span class="operator">||</span> a.emp_name</span><br><span class="line">    , LEVEL</span><br><span class="line">    , b.department_name</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    employees a</span><br><span class="line">    , departments b</span><br><span class="line"><span class="keyword">WHERE</span> a.department_id <span class="operator">=</span> b.department_id</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> a.manager_id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR a.employee_id <span class="operator">=</span> a.manager_id</span><br><span class="line">    <span class="keyword">AND</span> a.department_id <span class="operator">=</span> <span class="number">30</span></span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>employee_id</th>
        <th>LPAD(&#x27;&#x27;,3*(LEVEL-1))||A.EMP_NAME</th>
        <th>LEVEL</th>
        <th>department_name</th>
    </tr>
    <tr>
        <td>100</td>
        <td>Steven King</td>
        <td>1</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>114</td>
        <td>&nbsp;&nbsp;&nbsp;Den Raphaely</td>
        <td>2</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>115</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alexander Khoo</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>116</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shelli Baida</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>117</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sigal Tobias</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>118</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Guy Himuro</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>119</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Karen Colmenares</td>
        <td>3</td>
        <td>구매/생산부</td>
    </tr>
</table>


<ul>
<li>CONNECT BY PRIOR 자식컬럼 &#x3D; 부모컬럼 : 부모에서 자식으로 트리 구성 (TOP DOWN) -&gt; 일반적인 구조</li>
<li>CONNECT BY PRIOR 부모컬럼 &#x3D; 자식컬럼 : 자식에서 부모로 트리 구성 (Bottom UP)</li>
<li>CONNECT BY NOCYCLE PRIOR &#x3D; 무한루프 방지- p.226 WITH 절</li>
<li>kor_loan_status 테이블에서 연도별 최종월 기준 가장 대출이 많은 도시와 잔액을 구한다.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> b2.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> <span class="keyword">period</span>, region, <span class="built_in">sum</span>(loan_jan_amt) jan_amt</span><br><span class="line">         <span class="keyword">FROM</span> kor_loan_status </span><br><span class="line">         <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">period</span>, region</span><br><span class="line">      ) b2,      </span><br><span class="line">      ( <span class="keyword">SELECT</span> b.period,  <span class="built_in">MAX</span>(b.jan_amt) max_jan_amt</span><br><span class="line">         <span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> <span class="keyword">period</span>, region, <span class="built_in">sum</span>(loan_jan_amt) jan_amt</span><br><span class="line">                  <span class="keyword">FROM</span> kor_loan_status </span><br><span class="line">                 <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">period</span>, region</span><br><span class="line">              ) b,</span><br><span class="line">              ( <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(<span class="keyword">PERIOD</span>) max_month</span><br><span class="line">                  <span class="keyword">FROM</span> kor_loan_status</span><br><span class="line">                 <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(<span class="keyword">PERIOD</span>, <span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">              ) a</span><br><span class="line">         <span class="keyword">WHERE</span> b.period <span class="operator">=</span> a.max_month</span><br><span class="line">         <span class="keyword">GROUP</span> <span class="keyword">BY</span> b.period</span><br><span class="line">      ) c   </span><br><span class="line"> <span class="keyword">WHERE</span> b2.period <span class="operator">=</span> c.period</span><br><span class="line">   <span class="keyword">AND</span> b2.jan_amt <span class="operator">=</span> c.max_jan_amt</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>period</th>
        <th>region</th>
        <th>jan_amt</th>
    </tr>
    <tr>
        <td>201112</td>
        <td>서울</td>
        <td>334728.3</td>
    </tr>
    <tr>
        <td>201212</td>
        <td>서울</td>
        <td>331572.3</td>
    </tr>
    <tr>
        <td>201311</td>
        <td>서울</td>
        <td>334062.7</td>
    </tr>
</table>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- WITH 절은 별칭으로 사용한 SELECT 문의 FROM 절에 다른 SELECT 구문의 별칭 참조가 가능하다.</span><br></pre></td></tr></table></figure>

<ul>
<li>WITH 동일 구문 반복 사용 시</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> b2 <span class="keyword">AS</span> (<span class="keyword">SELECT</span> <span class="keyword">period</span>, region, <span class="built_in">sum</span>(loan_jan_amt) jan_amt</span><br><span class="line">         <span class="keyword">FROM</span> kor_loan_status </span><br><span class="line">         <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">period</span>, region)</span><br><span class="line">     , c <span class="keyword">AS</span> (<span class="keyword">SELECT</span> b.period, <span class="built_in">MAX</span>(b.jan_amt) max_jan_amt</span><br><span class="line">             <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">period</span>, region, <span class="built_in">sum</span>(loan_jan_amt) jan_amt</span><br><span class="line">                 <span class="keyword">FROM</span> kor_loan_status </span><br><span class="line">                 <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">period</span>, region) b</span><br><span class="line">                 , (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(<span class="keyword">PERIOD</span>) max_month</span><br><span class="line">                    <span class="keyword">FROM</span> kor_loan_status</span><br><span class="line">                    <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(<span class="keyword">PERIOD</span>, <span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">                 ) a</span><br><span class="line">             <span class="keyword">WHERE</span> b.period <span class="operator">=</span> a.max_month</span><br><span class="line">             <span class="keyword">GROUP</span> <span class="keyword">BY</span> b.period</span><br><span class="line">           ) <span class="comment">-- AS SELECT </span></span><br><span class="line"><span class="keyword">SELECT</span> b2.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> b2, c</span><br><span class="line"><span class="keyword">WHERE</span> b2.period <span class="operator">=</span> c.period</span><br><span class="line">    <span class="keyword">AND</span> b2.jan_amt <span class="operator">=</span> c.max_jan_amt</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>period</th>
        <th>region</th>
        <th>jan_amt</th>
    </tr>
    <tr>
        <td>201112</td>
        <td>서울</td>
        <td>334728.3</td>
    </tr>
    <tr>
        <td>201212</td>
        <td>서울</td>
        <td>331572.3</td>
    </tr>
    <tr>
        <td>201311</td>
        <td>서울</td>
        <td>334062.7</td>
    </tr>
</table>


<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQK을 다루는 기술</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-14T00:00:00.000Z" title="2022. 5. 14. 오전 9:00:00">2022-05-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-19T11:42:02.994Z" title="2022. 5. 19. 오후 8:42:02">2022-05-19</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/oracle/">oracle</a></span><span class="level-item">7 minutes read (About 1040 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/14/Oracle_ch07_0428/">Oracle_practice7</a></h1><div class="content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- WINDOW Function</span><br><span class="line">- 분석 함수 : 특정 그룹별 집계를 담당함</span><br><span class="line">              함수의 종류</span><br><span class="line"></span><br><span class="line">- PARTITION BY : 분석 함수로 계산될 대상 row의 그룹(파티션)을 지정</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%load_ext sql</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sql oracle://ora_user:evan@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1521</span>/myoracle</span><br></pre></td></tr></table></figure>
<ul>
<li><p>윈도우 함수</p>
</li>
<li><p>ROW_NUMBER()</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    department_id</span><br><span class="line">    , emp_name</span><br><span class="line">    , <span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> department_id, emp_name) dep_rows</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>emp_name</th>
        <th>dep_rows</th>
    </tr>
    <tr>
        <td>10</td>
        <td>Jennifer Whalen</td>
        <td>1</td>
    </tr>
    <tr>
        <td>20</td>
        <td>Michael Hartstein</td>
        <td>1</td>
    </tr>
    <tr>
        <td>20</td>
        <td>Pat Fay</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Alexander Khoo</td>
        <td>1</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Den Raphaely</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Guy Himuro</td>
        <td>3</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Karen Colmenares</td>
        <td>4</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Shelli Baida</td>
        <td>5</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Sigal Tobias</td>
        <td>6</td>
    </tr>
    <tr>
        <td>40</td>
        <td>Susan Mavris</td>
        <td>1</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Adam Fripp</td>
        <td>1</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Alana Walsh</td>
        <td>2</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Alexis Bull</td>
        <td>3</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Anthony Cabrio</td>
        <td>4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Britney Everett</td>
        <td>5</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Curtis Davies</td>
        <td>6</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Donald OConnell</td>
        <td>7</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Douglas Grant</td>
        <td>8</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Girard Geoni</td>
        <td>9</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Hazel Philtanker</td>
        <td>10</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Irene Mikkilineni</td>
        <td>11</td>
    </tr>
    <tr>
        <td>50</td>
        <td>James Landry</td>
        <td>12</td>
    </tr>
    <tr>
        <td>50</td>
        <td>James Marlow</td>
        <td>13</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jason Mallin</td>
        <td>14</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jean Fleaur</td>
        <td>15</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jennifer Dilly</td>
        <td>16</td>
    </tr>
    <tr>
        <td>50</td>
        <td>John Seo</td>
        <td>17</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Joshua Patel</td>
        <td>18</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Julia Dellinger</td>
        <td>19</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Julia Nayer</td>
        <td>20</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kelly Chung</td>
        <td>21</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kevin Feeney</td>
        <td>22</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kevin Mourgos</td>
        <td>23</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Ki Gee</td>
        <td>24</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Laura Bissot</td>
        <td>25</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Martha Sullivan</td>
        <td>26</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Matthew Weiss</td>
        <td>27</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Michael Rogers</td>
        <td>28</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Mozhe Atkinson</td>
        <td>29</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Nandita Sarchand</td>
        <td>30</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Payam Kaufling</td>
        <td>31</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Peter Vargas</td>
        <td>32</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Randall Matos</td>
        <td>33</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Randall Perkins</td>
        <td>34</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Renske Ladwig</td>
        <td>35</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Samuel McCain</td>
        <td>36</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Sarah Bell</td>
        <td>37</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Shanta Vollman</td>
        <td>38</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Stephen Stiles</td>
        <td>39</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Steven Markle</td>
        <td>40</td>
    </tr>
    <tr>
        <td>50</td>
        <td>TJ Olson</td>
        <td>41</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Timothy Gates</td>
        <td>42</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Trenna Rajs</td>
        <td>43</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Vance Jones</td>
        <td>44</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Winston Taylor</td>
        <td>45</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Alexander Hunold</td>
        <td>1</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Bruce Ernst</td>
        <td>2</td>
    </tr>
    <tr>
        <td>60</td>
        <td>David Austin</td>
        <td>3</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Diana Lorentz</td>
        <td>4</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Valli Pataballa</td>
        <td>5</td>
    </tr>
    <tr>
        <td>70</td>
        <td>Hermann Baer</td>
        <td>1</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Alberto Errazuriz</td>
        <td>1</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Allan McEwen</td>
        <td>2</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Alyssa Hutton</td>
        <td>3</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Amit Banda</td>
        <td>4</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Charles Johnson</td>
        <td>5</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Christopher Olsen</td>
        <td>6</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Clara Vishney</td>
        <td>7</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Danielle Greene</td>
        <td>8</td>
    </tr>
    <tr>
        <td>80</td>
        <td>David Bernstein</td>
        <td>9</td>
    </tr>
    <tr>
        <td>80</td>
        <td>David Lee</td>
        <td>10</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Eleni Zlotkey</td>
        <td>11</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Elizabeth Bates</td>
        <td>12</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Ellen Abel</td>
        <td>13</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Gerald Cambrault</td>
        <td>14</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Harrison Bloom</td>
        <td>15</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Jack Livingston</td>
        <td>16</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Janette King</td>
        <td>17</td>
    </tr>
    <tr>
        <td>80</td>
        <td>John Russell</td>
        <td>18</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Jonathon Taylor</td>
        <td>19</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Karen Partners</td>
        <td>20</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Lindsey Smith</td>
        <td>21</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Lisa Ozer</td>
        <td>22</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Louise Doran</td>
        <td>23</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Mattea Marvins</td>
        <td>24</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Nanette Cambrault</td>
        <td>25</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Oliver Tuvault</td>
        <td>26</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Patrick Sully</td>
        <td>27</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Peter Hall</td>
        <td>28</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Peter Tucker</td>
        <td>29</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sarath Sewall</td>
        <td>30</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sundar Ande</td>
        <td>31</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sundita Kumar</td>
        <td>32</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Tayler Fox</td>
        <td>33</td>
    </tr>
    <tr>
        <td>80</td>
        <td>William Smith</td>
        <td>34</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Lex De Haan</td>
        <td>1</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Neena Kochhar</td>
        <td>2</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Steven King</td>
        <td>3</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Daniel Faviet</td>
        <td>1</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Ismael Sciarra</td>
        <td>2</td>
    </tr>
    <tr>
        <td>100</td>
        <td>John Chen</td>
        <td>3</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Jose Manuel Urman</td>
        <td>4</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Luis Popp</td>
        <td>5</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Nancy Greenberg</td>
        <td>6</td>
    </tr>
    <tr>
        <td>110</td>
        <td>Shelley Higgins</td>
        <td>1</td>
    </tr>
    <tr>
        <td>110</td>
        <td>William Gietz</td>
        <td>2</td>
    </tr>
    <tr>
        <td>None</td>
        <td>Kimberely Grant</td>
        <td>1</td>
    </tr>
</table>


<ul>
<li>RANK(), DENSE_RANK()</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    department_id</span><br><span class="line">    , emp_name</span><br><span class="line">    , salary</span><br><span class="line">    , <span class="built_in">RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                   <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary) dep_rank</span><br><span class="line">    , <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                         <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary) dep_denserank</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>emp_name</th>
        <th>salary</th>
        <th>dep_rank</th>
        <th>dep_denserank</th>
    </tr>
    <tr>
        <td>10</td>
        <td>Jennifer Whalen</td>
        <td>4400</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>20</td>
        <td>Pat Fay</td>
        <td>6000</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>20</td>
        <td>Michael Hartstein</td>
        <td>13000</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Karen Colmenares</td>
        <td>2500</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Guy Himuro</td>
        <td>2600</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Sigal Tobias</td>
        <td>2800</td>
        <td>3</td>
        <td>3</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Shelli Baida</td>
        <td>2900</td>
        <td>4</td>
        <td>4</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Alexander Khoo</td>
        <td>3100</td>
        <td>5</td>
        <td>5</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Den Raphaely</td>
        <td>11000</td>
        <td>6</td>
        <td>6</td>
    </tr>
    <tr>
        <td>40</td>
        <td>Susan Mavris</td>
        <td>6500</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>50</td>
        <td>TJ Olson</td>
        <td>2100</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Steven Markle</td>
        <td>2200</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Hazel Philtanker</td>
        <td>2200</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Ki Gee</td>
        <td>2400</td>
        <td>4</td>
        <td>3</td>
    </tr>
    <tr>
        <td>50</td>
        <td>James Landry</td>
        <td>2400</td>
        <td>4</td>
        <td>3</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Randall Perkins</td>
        <td>2500</td>
        <td>6</td>
        <td>4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Martha Sullivan</td>
        <td>2500</td>
        <td>6</td>
        <td>4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Joshua Patel</td>
        <td>2500</td>
        <td>6</td>
        <td>4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Peter Vargas</td>
        <td>2500</td>
        <td>6</td>
        <td>4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>James Marlow</td>
        <td>2500</td>
        <td>6</td>
        <td>4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Donald OConnell</td>
        <td>2600</td>
        <td>11</td>
        <td>5</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Douglas Grant</td>
        <td>2600</td>
        <td>11</td>
        <td>5</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Randall Matos</td>
        <td>2600</td>
        <td>11</td>
        <td>5</td>
    </tr>
    <tr>
        <td>50</td>
        <td>John Seo</td>
        <td>2700</td>
        <td>14</td>
        <td>6</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Irene Mikkilineni</td>
        <td>2700</td>
        <td>14</td>
        <td>6</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Mozhe Atkinson</td>
        <td>2800</td>
        <td>16</td>
        <td>7</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Vance Jones</td>
        <td>2800</td>
        <td>16</td>
        <td>7</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Girard Geoni</td>
        <td>2800</td>
        <td>16</td>
        <td>7</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Michael Rogers</td>
        <td>2900</td>
        <td>19</td>
        <td>8</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Timothy Gates</td>
        <td>2900</td>
        <td>19</td>
        <td>8</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kevin Feeney</td>
        <td>3000</td>
        <td>21</td>
        <td>9</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Anthony Cabrio</td>
        <td>3000</td>
        <td>21</td>
        <td>9</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jean Fleaur</td>
        <td>3100</td>
        <td>23</td>
        <td>10</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Curtis Davies</td>
        <td>3100</td>
        <td>23</td>
        <td>10</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Alana Walsh</td>
        <td>3100</td>
        <td>23</td>
        <td>10</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Stephen Stiles</td>
        <td>3200</td>
        <td>26</td>
        <td>11</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Winston Taylor</td>
        <td>3200</td>
        <td>26</td>
        <td>11</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Julia Nayer</td>
        <td>3200</td>
        <td>26</td>
        <td>11</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Samuel McCain</td>
        <td>3200</td>
        <td>26</td>
        <td>11</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Laura Bissot</td>
        <td>3300</td>
        <td>30</td>
        <td>12</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jason Mallin</td>
        <td>3300</td>
        <td>30</td>
        <td>12</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Julia Dellinger</td>
        <td>3400</td>
        <td>32</td>
        <td>13</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Trenna Rajs</td>
        <td>3500</td>
        <td>33</td>
        <td>14</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Renske Ladwig</td>
        <td>3600</td>
        <td>34</td>
        <td>15</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jennifer Dilly</td>
        <td>3600</td>
        <td>34</td>
        <td>15</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kelly Chung</td>
        <td>3800</td>
        <td>36</td>
        <td>16</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Britney Everett</td>
        <td>3900</td>
        <td>37</td>
        <td>17</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Sarah Bell</td>
        <td>4000</td>
        <td>38</td>
        <td>18</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Alexis Bull</td>
        <td>4100</td>
        <td>39</td>
        <td>19</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Nandita Sarchand</td>
        <td>4200</td>
        <td>40</td>
        <td>20</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kevin Mourgos</td>
        <td>5800</td>
        <td>41</td>
        <td>21</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Shanta Vollman</td>
        <td>6500</td>
        <td>42</td>
        <td>22</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Payam Kaufling</td>
        <td>7900</td>
        <td>43</td>
        <td>23</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Matthew Weiss</td>
        <td>8000</td>
        <td>44</td>
        <td>24</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Adam Fripp</td>
        <td>8200</td>
        <td>45</td>
        <td>25</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Diana Lorentz</td>
        <td>4200</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Valli Pataballa</td>
        <td>4800</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>60</td>
        <td>David Austin</td>
        <td>4800</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Bruce Ernst</td>
        <td>6000</td>
        <td>4</td>
        <td>3</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Alexander Hunold</td>
        <td>9000</td>
        <td>5</td>
        <td>4</td>
    </tr>
    <tr>
        <td>70</td>
        <td>Hermann Baer</td>
        <td>10000</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sundita Kumar</td>
        <td>6100</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Charles Johnson</td>
        <td>6200</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Amit Banda</td>
        <td>6200</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sundar Ande</td>
        <td>6400</td>
        <td>4</td>
        <td>3</td>
    </tr>
    <tr>
        <td>80</td>
        <td>David Lee</td>
        <td>6800</td>
        <td>5</td>
        <td>4</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Oliver Tuvault</td>
        <td>7000</td>
        <td>6</td>
        <td>5</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sarath Sewall</td>
        <td>7000</td>
        <td>6</td>
        <td>5</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Mattea Marvins</td>
        <td>7200</td>
        <td>8</td>
        <td>6</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Elizabeth Bates</td>
        <td>7300</td>
        <td>9</td>
        <td>7</td>
    </tr>
    <tr>
        <td>80</td>
        <td>William Smith</td>
        <td>7400</td>
        <td>10</td>
        <td>8</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Nanette Cambrault</td>
        <td>7500</td>
        <td>11</td>
        <td>9</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Louise Doran</td>
        <td>7500</td>
        <td>11</td>
        <td>9</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Lindsey Smith</td>
        <td>8000</td>
        <td>13</td>
        <td>10</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Christopher Olsen</td>
        <td>8000</td>
        <td>13</td>
        <td>10</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Jack Livingston</td>
        <td>8400</td>
        <td>15</td>
        <td>11</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Jonathon Taylor</td>
        <td>8600</td>
        <td>16</td>
        <td>12</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Alyssa Hutton</td>
        <td>8800</td>
        <td>17</td>
        <td>13</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Allan McEwen</td>
        <td>9000</td>
        <td>18</td>
        <td>14</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Peter Hall</td>
        <td>9000</td>
        <td>18</td>
        <td>14</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Danielle Greene</td>
        <td>9500</td>
        <td>20</td>
        <td>15</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Patrick Sully</td>
        <td>9500</td>
        <td>20</td>
        <td>15</td>
    </tr>
    <tr>
        <td>80</td>
        <td>David Bernstein</td>
        <td>9500</td>
        <td>20</td>
        <td>15</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Tayler Fox</td>
        <td>9600</td>
        <td>23</td>
        <td>16</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Janette King</td>
        <td>10000</td>
        <td>24</td>
        <td>17</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Peter Tucker</td>
        <td>10000</td>
        <td>24</td>
        <td>17</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Harrison Bloom</td>
        <td>10000</td>
        <td>24</td>
        <td>17</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Eleni Zlotkey</td>
        <td>10500</td>
        <td>27</td>
        <td>18</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Clara Vishney</td>
        <td>10500</td>
        <td>27</td>
        <td>18</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Gerald Cambrault</td>
        <td>11000</td>
        <td>29</td>
        <td>19</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Ellen Abel</td>
        <td>11000</td>
        <td>29</td>
        <td>19</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Lisa Ozer</td>
        <td>11500</td>
        <td>31</td>
        <td>20</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Alberto Errazuriz</td>
        <td>12000</td>
        <td>32</td>
        <td>21</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Karen Partners</td>
        <td>13500</td>
        <td>33</td>
        <td>22</td>
    </tr>
    <tr>
        <td>80</td>
        <td>John Russell</td>
        <td>14000</td>
        <td>34</td>
        <td>23</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Lex De Haan</td>
        <td>17000</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Neena Kochhar</td>
        <td>17000</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Steven King</td>
        <td>24000</td>
        <td>3</td>
        <td>2</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Luis Popp</td>
        <td>6900</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Ismael Sciarra</td>
        <td>7700</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Jose Manuel Urman</td>
        <td>7800</td>
        <td>3</td>
        <td>3</td>
    </tr>
    <tr>
        <td>100</td>
        <td>John Chen</td>
        <td>8200</td>
        <td>4</td>
        <td>4</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Daniel Faviet</td>
        <td>9000</td>
        <td>5</td>
        <td>5</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Nancy Greenberg</td>
        <td>12008</td>
        <td>6</td>
        <td>6</td>
    </tr>
    <tr>
        <td>110</td>
        <td>William Gietz</td>
        <td>8300</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>110</td>
        <td>Shelley Higgins</td>
        <td>12008</td>
        <td>2</td>
        <td>2</td>
    </tr>
    <tr>
        <td>None</td>
        <td>Kimberely Grant</td>
        <td>7000</td>
        <td>1</td>
        <td>1</td>
    </tr>
</table>


<ul>
<li>CUME_DIST &amp; PERCENT_RANK</li>
<li>CUME_DIST : 주어진 그룹에 대한 상대 누적 분포도값</li>
<li>분포도 값(비율) 반환 값의 범위 0초와 1이하 사이의 값 반환</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    department_id</span><br><span class="line">    , emp_name</span><br><span class="line">    , <span class="built_in">CUME_DIST</span>() <span class="keyword">over</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary) dep_dist</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>emp_name</th>
        <th>dep_dist</th>
    </tr>
    <tr>
        <td>10</td>
        <td>Jennifer Whalen</td>
        <td>1</td>
    </tr>
    <tr>
        <td>20</td>
        <td>Pat Fay</td>
        <td>0.5</td>
    </tr>
    <tr>
        <td>20</td>
        <td>Michael Hartstein</td>
        <td>1</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Karen Colmenares</td>
        <td>0.1666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Guy Himuro</td>
        <td>0.3333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Sigal Tobias</td>
        <td>0.5</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Shelli Baida</td>
        <td>0.6666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Alexander Khoo</td>
        <td>0.8333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Den Raphaely</td>
        <td>1</td>
    </tr>
    <tr>
        <td>40</td>
        <td>Susan Mavris</td>
        <td>1</td>
    </tr>
    <tr>
        <td>50</td>
        <td>TJ Olson</td>
        <td>0.0222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Steven Markle</td>
        <td>0.0666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Hazel Philtanker</td>
        <td>0.0666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Ki Gee</td>
        <td>0.1111111111111111111111111111111111111111</td>
    </tr>
    <tr>
        <td>50</td>
        <td>James Landry</td>
        <td>0.1111111111111111111111111111111111111111</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Randall Perkins</td>
        <td>0.2222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Martha Sullivan</td>
        <td>0.2222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Joshua Patel</td>
        <td>0.2222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Peter Vargas</td>
        <td>0.2222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>James Marlow</td>
        <td>0.2222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Donald OConnell</td>
        <td>0.2888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Douglas Grant</td>
        <td>0.2888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Randall Matos</td>
        <td>0.2888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>John Seo</td>
        <td>0.3333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Irene Mikkilineni</td>
        <td>0.3333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Mozhe Atkinson</td>
        <td>0.4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Vance Jones</td>
        <td>0.4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Girard Geoni</td>
        <td>0.4</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Michael Rogers</td>
        <td>0.4444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Timothy Gates</td>
        <td>0.4444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kevin Feeney</td>
        <td>0.4888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Anthony Cabrio</td>
        <td>0.4888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jean Fleaur</td>
        <td>0.5555555555555555555555555555555555555556</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Curtis Davies</td>
        <td>0.5555555555555555555555555555555555555556</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Alana Walsh</td>
        <td>0.5555555555555555555555555555555555555556</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Stephen Stiles</td>
        <td>0.6444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Winston Taylor</td>
        <td>0.6444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Julia Nayer</td>
        <td>0.6444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Samuel McCain</td>
        <td>0.6444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Laura Bissot</td>
        <td>0.6888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jason Mallin</td>
        <td>0.6888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Julia Dellinger</td>
        <td>0.7111111111111111111111111111111111111111</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Trenna Rajs</td>
        <td>0.7333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Renske Ladwig</td>
        <td>0.7777777777777777777777777777777777777778</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Jennifer Dilly</td>
        <td>0.7777777777777777777777777777777777777778</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kelly Chung</td>
        <td>0.8</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Britney Everett</td>
        <td>0.8222222222222222222222222222222222222222</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Sarah Bell</td>
        <td>0.8444444444444444444444444444444444444444</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Alexis Bull</td>
        <td>0.8666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Nandita Sarchand</td>
        <td>0.8888888888888888888888888888888888888889</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Kevin Mourgos</td>
        <td>0.9111111111111111111111111111111111111111</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Shanta Vollman</td>
        <td>0.9333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Payam Kaufling</td>
        <td>0.9555555555555555555555555555555555555556</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Matthew Weiss</td>
        <td>0.9777777777777777777777777777777777777778</td>
    </tr>
    <tr>
        <td>50</td>
        <td>Adam Fripp</td>
        <td>1</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Diana Lorentz</td>
        <td>0.2</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Valli Pataballa</td>
        <td>0.6</td>
    </tr>
    <tr>
        <td>60</td>
        <td>David Austin</td>
        <td>0.6</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Bruce Ernst</td>
        <td>0.8</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Alexander Hunold</td>
        <td>1</td>
    </tr>
    <tr>
        <td>70</td>
        <td>Hermann Baer</td>
        <td>1</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sundita Kumar</td>
        <td>0.0294117647058823529411764705882352941176</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Charles Johnson</td>
        <td>0.0882352941176470588235294117647058823529</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Amit Banda</td>
        <td>0.0882352941176470588235294117647058823529</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sundar Ande</td>
        <td>0.1176470588235294117647058823529411764706</td>
    </tr>
    <tr>
        <td>80</td>
        <td>David Lee</td>
        <td>0.1470588235294117647058823529411764705882</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Oliver Tuvault</td>
        <td>0.2058823529411764705882352941176470588235</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Sarath Sewall</td>
        <td>0.2058823529411764705882352941176470588235</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Mattea Marvins</td>
        <td>0.2352941176470588235294117647058823529412</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Elizabeth Bates</td>
        <td>0.2647058823529411764705882352941176470588</td>
    </tr>
    <tr>
        <td>80</td>
        <td>William Smith</td>
        <td>0.2941176470588235294117647058823529411765</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Nanette Cambrault</td>
        <td>0.3529411764705882352941176470588235294118</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Louise Doran</td>
        <td>0.3529411764705882352941176470588235294118</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Lindsey Smith</td>
        <td>0.4117647058823529411764705882352941176471</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Christopher Olsen</td>
        <td>0.4117647058823529411764705882352941176471</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Jack Livingston</td>
        <td>0.4411764705882352941176470588235294117647</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Jonathon Taylor</td>
        <td>0.4705882352941176470588235294117647058824</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Alyssa Hutton</td>
        <td>0.5</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Allan McEwen</td>
        <td>0.5588235294117647058823529411764705882353</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Peter Hall</td>
        <td>0.5588235294117647058823529411764705882353</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Danielle Greene</td>
        <td>0.6470588235294117647058823529411764705882</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Patrick Sully</td>
        <td>0.6470588235294117647058823529411764705882</td>
    </tr>
    <tr>
        <td>80</td>
        <td>David Bernstein</td>
        <td>0.6470588235294117647058823529411764705882</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Tayler Fox</td>
        <td>0.6764705882352941176470588235294117647059</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Janette King</td>
        <td>0.7647058823529411764705882352941176470588</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Peter Tucker</td>
        <td>0.7647058823529411764705882352941176470588</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Harrison Bloom</td>
        <td>0.7647058823529411764705882352941176470588</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Eleni Zlotkey</td>
        <td>0.8235294117647058823529411764705882352941</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Clara Vishney</td>
        <td>0.8235294117647058823529411764705882352941</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Gerald Cambrault</td>
        <td>0.8823529411764705882352941176470588235294</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Ellen Abel</td>
        <td>0.8823529411764705882352941176470588235294</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Lisa Ozer</td>
        <td>0.9117647058823529411764705882352941176471</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Alberto Errazuriz</td>
        <td>0.9411764705882352941176470588235294117647</td>
    </tr>
    <tr>
        <td>80</td>
        <td>Karen Partners</td>
        <td>0.9705882352941176470588235294117647058824</td>
    </tr>
    <tr>
        <td>80</td>
        <td>John Russell</td>
        <td>1</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Lex De Haan</td>
        <td>0.6666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Neena Kochhar</td>
        <td>0.6666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>90</td>
        <td>Steven King</td>
        <td>1</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Luis Popp</td>
        <td>0.1666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Ismael Sciarra</td>
        <td>0.3333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Jose Manuel Urman</td>
        <td>0.5</td>
    </tr>
    <tr>
        <td>100</td>
        <td>John Chen</td>
        <td>0.6666666666666666666666666666666666666667</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Daniel Faviet</td>
        <td>0.8333333333333333333333333333333333333333</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Nancy Greenberg</td>
        <td>1</td>
    </tr>
    <tr>
        <td>110</td>
        <td>William Gietz</td>
        <td>0.5</td>
    </tr>
    <tr>
        <td>110</td>
        <td>Shelley Higgins</td>
        <td>1</td>
    </tr>
    <tr>
        <td>None</td>
        <td>Kimberely Grant</td>
        <td>1</td>
    </tr>
</table>


<ul>
<li>NTILE 함수</li>
<li>NTILE(4) 값을 4등분 함</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    department_id</span><br><span class="line">    , emp_name</span><br><span class="line">    , salary</span><br><span class="line">    , <span class="built_in">NTILE</span>(<span class="number">4</span>) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> department_id</span><br><span class="line">                     <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary) NTILES</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">30</span>, <span class="number">60</span>)</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>department_id</th>
        <th>emp_name</th>
        <th>salary</th>
        <th>ntiles</th>
    </tr>
    <tr>
        <td>30</td>
        <td>Karen Colmenares</td>
        <td>2500</td>
        <td>1</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Guy Himuro</td>
        <td>2600</td>
        <td>1</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Sigal Tobias</td>
        <td>2800</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Shelli Baida</td>
        <td>2900</td>
        <td>2</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Alexander Khoo</td>
        <td>3100</td>
        <td>3</td>
    </tr>
    <tr>
        <td>30</td>
        <td>Den Raphaely</td>
        <td>11000</td>
        <td>4</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Diana Lorentz</td>
        <td>4200</td>
        <td>1</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Valli Pataballa</td>
        <td>4800</td>
        <td>1</td>
    </tr>
    <tr>
        <td>60</td>
        <td>David Austin</td>
        <td>4800</td>
        <td>2</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Bruce Ernst</td>
        <td>6000</td>
        <td>3</td>
    </tr>
    <tr>
        <td>60</td>
        <td>Alexander Hunold</td>
        <td>9000</td>
        <td>4</td>
    </tr>
</table>


<ul>
<li>LAG : 선행 로우의 값을 참조한다.</li>
<li>LEAD : 후행 로우의 값 참조</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    emp_name</span><br><span class="line">    , hire_date</span><br><span class="line">    , salary</span><br><span class="line">    , <span class="built_in">LAG</span>(salary, <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date) <span class="keyword">AS</span> prev_sal</span><br><span class="line">    , <span class="built_in">LEAD</span>(salary, <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date) <span class="keyword">AS</span> next_sal</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">30</span></span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>emp_name</th>
        <th>hire_date</th>
        <th>salary</th>
        <th>prev_sal</th>
        <th>next_sal</th>
    </tr>
    <tr>
        <td>Den Raphaely</td>
        <td>2002-12-07 00:00:00</td>
        <td>11000</td>
        <td>0</td>
        <td>3100</td>
    </tr>
    <tr>
        <td>Alexander Khoo</td>
        <td>2003-05-18 00:00:00</td>
        <td>3100</td>
        <td>11000</td>
        <td>2800</td>
    </tr>
    <tr>
        <td>Sigal Tobias</td>
        <td>2005-07-24 00:00:00</td>
        <td>2800</td>
        <td>3100</td>
        <td>2900</td>
    </tr>
    <tr>
        <td>Shelli Baida</td>
        <td>2005-12-24 00:00:00</td>
        <td>2900</td>
        <td>2800</td>
        <td>2600</td>
    </tr>
    <tr>
        <td>Guy Himuro</td>
        <td>2006-11-15 00:00:00</td>
        <td>2600</td>
        <td>2900</td>
        <td>2500</td>
    </tr>
    <tr>
        <td>Karen Colmenares</td>
        <td>2007-08-10 00:00:00</td>
        <td>2500</td>
        <td>2600</td>
        <td>0</td>
    </tr>
</table>


<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-13T00:00:00.000Z" title="2022. 5. 13. 오전 9:00:00">2022-05-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-17T11:11:08.607Z" title="2022. 5. 17. 오후 8:11:08">2022-05-17</time></span><span class="level-item"> minkuen </span><span class="level-item"><a class="link-muted" href="/categories/SQL/">SQL</a><span> / </span><a class="link-muted" href="/categories/SQL/oracle/">oracle</a></span><span class="level-item">9 minutes read (About 1371 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/05/13/Oracle_ch06_0428_2/">Oracle_practice6_3</a></h1><div class="content"><ul>
<li>6장 조인과 서브쿼리&#x2F;후반</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%load_ext sql</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sql oracle://ora_user:evan@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1521</span>/myoracle</span><br></pre></td></tr></table></figure>
<ul>
<li>p.198</li>
<li>기획부 산하에 있는 부서에 속한 사원의 평균급여보다 많은 급여를 받는 사원- 서브쿼리</li>
<li>오전 : WHERE, SELECT</li>
<li>오후 : FROM</li>
<li>기획부 : 부서 테이블</li>
<li>급여 : 사원 테이블</li>
</ul>
<p>SELECT<br>    a.employee_id<br>    , a.emp_name<br>    , b.department_id<br>    , b.department_name<br>FROM<br>    employees a<br>    , departments b<br>    (서브쿼리) d – 기획부 평균급여<br>WHERE a.deartment_id &#x3D; b.department_id<br>    AND a.salary &gt; d.avg_salary</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.employee_id</span><br><span class="line">    , a.emp_name</span><br><span class="line">    , b.department_id</span><br><span class="line">    , b.department_name</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    employees a</span><br><span class="line">    , departments b</span><br><span class="line">    , (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(c.salary) <span class="keyword">AS</span> avg_salary</span><br><span class="line">       <span class="keyword">FROM</span></span><br><span class="line">       departments b</span><br><span class="line">       , employees c</span><br><span class="line">       <span class="keyword">WHERE</span> b.parent_id <span class="operator">=</span> <span class="number">90</span></span><br><span class="line">       <span class="keyword">AND</span> b.department_id <span class="operator">=</span> c.department_id) d</span><br><span class="line"><span class="keyword">WHERE</span> a.department_id <span class="operator">=</span> b.department_id</span><br><span class="line">    <span class="keyword">AND</span> a.salary <span class="operator">&gt;</span> d.avg_salary</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>employee_id</th>
        <th>emp_name</th>
        <th>department_id</th>
        <th>department_name</th>
    </tr>
    <tr>
        <td>201</td>
        <td>Michael Hartstein</td>
        <td>20</td>
        <td>마케팅</td>
    </tr>
    <tr>
        <td>114</td>
        <td>Den Raphaely</td>
        <td>30</td>
        <td>구매/생산부</td>
    </tr>
    <tr>
        <td>120</td>
        <td>Matthew Weiss</td>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>121</td>
        <td>Adam Fripp</td>
        <td>50</td>
        <td>배송부</td>
    </tr>
    <tr>
        <td>103</td>
        <td>Alexander Hunold</td>
        <td>60</td>
        <td>IT</td>
    </tr>
    <tr>
        <td>204</td>
        <td>Hermann Baer</td>
        <td>70</td>
        <td>홍보부</td>
    </tr>
    <tr>
        <td>145</td>
        <td>John Russell</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>146</td>
        <td>Karen Partners</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>147</td>
        <td>Alberto Errazuriz</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>148</td>
        <td>Gerald Cambrault</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>149</td>
        <td>Eleni Zlotkey</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>150</td>
        <td>Peter Tucker</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>151</td>
        <td>David Bernstein</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>152</td>
        <td>Peter Hall</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>153</td>
        <td>Christopher Olsen</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>156</td>
        <td>Janette King</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>157</td>
        <td>Patrick Sully</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>158</td>
        <td>Allan McEwen</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>159</td>
        <td>Lindsey Smith</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>162</td>
        <td>Clara Vishney</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>163</td>
        <td>Danielle Greene</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>168</td>
        <td>Lisa Ozer</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>169</td>
        <td>Harrison Bloom</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>170</td>
        <td>Tayler Fox</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>174</td>
        <td>Ellen Abel</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>175</td>
        <td>Alyssa Hutton</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>176</td>
        <td>Jonathon Taylor</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>177</td>
        <td>Jack Livingston</td>
        <td>80</td>
        <td>영업부</td>
    </tr>
    <tr>
        <td>100</td>
        <td>Steven King</td>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>101</td>
        <td>Neena Kochhar</td>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>102</td>
        <td>Lex De Haan</td>
        <td>90</td>
        <td>기획부</td>
    </tr>
    <tr>
        <td>108</td>
        <td>Nancy Greenberg</td>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>109</td>
        <td>Daniel Faviet</td>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>110</td>
        <td>John Chen</td>
        <td>100</td>
        <td>자금부</td>
    </tr>
    <tr>
        <td>205</td>
        <td>Shelley Higgins</td>
        <td>110</td>
        <td>경리부</td>
    </tr>
    <tr>
        <td>206</td>
        <td>William Gietz</td>
        <td>110</td>
        <td>경리부</td>
    </tr>
</table>




<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(c.salary) <span class="keyword">AS</span> avg_salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    departments b</span><br><span class="line">    , employees c</span><br><span class="line"><span class="keyword">WHERE</span> b.parent_id <span class="operator">=</span> <span class="number">90</span></span><br><span class="line">    <span class="keyword">AND</span> b.department_id <span class="operator">=</span> c.department_id</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>avg_salary</th>
    </tr>
    <tr>
        <td>7908.285714285714285714285714285714285714</td>
    </tr>
</table>


<ul>
<li>p.200</li>
<li>2000년 이탈리아 평균 매출액(연평균)보다 큰 월의 평균 매출액은 구함</li>
<li>첫 번째 서브쿼리 : 월 평균 매출 구하는 것</li>
<li>두 번째 서브쿼리 : 연평균 매출액을 구하는 것%%sql</li>
</ul>
<p>SELECT a.*<br>    FROM<br>        (서브쿼리) a – 월 평균 매출액<br>         , (서브쿼리) b – 연 평균 매출액<br>    WHERE a.month_avg&gt;b.year_avg  – 연 평균 이상의 월 평균을 구한다.- 이 쿼리는 두 개의 서브 쿼리를 FROM 절에 위치시켰다. </p>
<ul>
<li>2000년 이탈리아 평균 매출액(연평균)보다 큰 달의 평균 매출액을 구해야 한다.</li>
<li>첫 번째 서브 쿼리에서는 월별 평균 매출액을, 두 번째 서브 쿼리에서는 연평균 매출액을 구한다.<br>그 다음에 ‘월 평균 매출액 &gt; 연 평균 매출액’ 조건을 만족하는 월 평균매출액을 출력한다.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> a.<span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> </span><br><span class="line">        (<span class="keyword">SELECT</span> a.sales_month, ROUND(<span class="built_in">AVG</span>(a.amount_sold)) month_avg</span><br><span class="line">         <span class="keyword">FROM</span> </span><br><span class="line">             sales a</span><br><span class="line">             , customers b</span><br><span class="line">             , countries c</span><br><span class="line">         <span class="keyword">WHERE</span> a.sales_month <span class="keyword">BETWEEN</span> <span class="string">&#x27;200001&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;200012&#x27;</span></span><br><span class="line">             <span class="keyword">AND</span> a.cust_id <span class="operator">=</span> b.CUST_ID</span><br><span class="line">             <span class="keyword">AND</span> b.COUNTRY_ID <span class="operator">=</span> c.COUNTRY_ID</span><br><span class="line">             <span class="keyword">AND</span> c.COUNTRY_NAME <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span></span><br><span class="line">         <span class="keyword">GROUP</span> <span class="keyword">BY</span> a.sales_month ) a</span><br><span class="line">        , (<span class="keyword">SELECT</span> </span><br><span class="line">               ROUND(<span class="built_in">AVG</span>(a.amount_sold)) <span class="keyword">AS</span> year_avg</span><br><span class="line">           <span class="keyword">FROM</span></span><br><span class="line">               sales a</span><br><span class="line">               , customers b</span><br><span class="line">               , countries c</span><br><span class="line">           <span class="keyword">WHERE</span> a.sales_month <span class="keyword">BETWEEN</span> <span class="string">&#x27;200001&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;200012&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> a.cust_id <span class="operator">=</span> b.CUST_ID</span><br><span class="line">               <span class="keyword">AND</span> b.COUNTRY_ID <span class="operator">=</span> c.COUNTRY_ID</span><br><span class="line">               <span class="keyword">AND</span> c.COUNTRY_NAME <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span>) b</span><br><span class="line">    <span class="keyword">WHERE</span> a.month_avg<span class="operator">&gt;</span>b.year_avg </span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>sales_month</th>
        <th>month_avg</th>
    </tr>
    <tr>
        <td>200002</td>
        <td>137</td>
    </tr>
    <tr>
        <td>200007</td>
        <td>122</td>
    </tr>
    <tr>
        <td>200009</td>
        <td>110</td>
    </tr>
    <tr>
        <td>200012</td>
        <td>184</td>
    </tr>
</table>


<ul>
<li><p>ERD 참고<br><img src="attachment:f9c83be6-d1e8-4587-9d1e-546263376b70.jpg" alt="ERD_000.jpg"></p>
</li>
<li><p>p.200</p>
</li>
<li><p>복잡한 쿼리 작성법 예시</p>
</li>
<li><p>(1), (2) –&gt; 메인쿼리 작성</p>
</li>
<li><p>(3), (4) –&gt; 서브쿼리 작성 후 합치기</p>
</li>
<li><p>연도별로 이탈리아 매출 데이터를 살펴</p>
</li>
<li><p>매출실적이 가장 많은 사원의 목록과 매출액을 구하라</p>
</li>
<li><p>연도, 최대매출사원, 최대매출액</p>
</li>
<li><p>이탈리아 찾기 : countries</p>
</li>
<li><p>이탈리아 고객 : customers</p>
</li>
<li><p>매출 : sales</p>
</li>
<li><p>사원정보 : employees</p>
</li>
<li><p>(1) 연도, 사원별 이탈리아 매출액 구하기</p>
</li>
<li><p>이탈리아 고객 찾기 : customers, countries country_id로 조인</p>
</li>
<li><p>이탈리아 매출 찾기 : 위 결과와 sales 테이블을 cust_id로 조인</p>
</li>
<li><p>최대 매출액 구하려면 MAX 함수 쓰고, 연도별로 GROUP BY</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">as</span> years</span><br><span class="line">    , a.employee_id</span><br><span class="line">    , <span class="built_in">SUM</span>(a.amount_sold) <span class="keyword">AS</span> amount_sold</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    sales a</span><br><span class="line">    , customers b </span><br><span class="line">    , countries c </span><br><span class="line"><span class="keyword">WHERE</span> a.cust_id <span class="operator">=</span> b.cust_id</span><br><span class="line">    <span class="keyword">AND</span> b.country_id <span class="operator">=</span> c.country_id </span><br><span class="line">    <span class="keyword">AND</span> c.country_name <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span> </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>), a.employee_id</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>years</th>
        <th>employee_id</th>
        <th>amount_sold</th>
    </tr>
    <tr>
        <td>1998</td>
        <td>1</td>
        <td>5404.82</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>170</td>
        <td>10822.62</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>150</td>
        <td>132543.37</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>175</td>
        <td>126982.7</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>160</td>
        <td>72663.95</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>171</td>
        <td>62765.84</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>176</td>
        <td>69330.91</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>153</td>
        <td>142987.82</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>167</td>
        <td>171591.21</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>153</td>
        <td>2443.72</td>
    </tr>
    <tr>
        <td>1998</td>
        <td>156</td>
        <td>121910.05</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>168</td>
        <td>100289.54</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>172</td>
        <td>96872.2</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>169</td>
        <td>102573.99</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>145</td>
        <td>4646.74</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>163</td>
        <td>92604.53</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>179</td>
        <td>123200.62</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>149</td>
        <td>138663.65</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>154</td>
        <td>83216.54</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>176</td>
        <td>9718.24</td>
    </tr>
    <tr>
        <td>1998</td>
        <td>157</td>
        <td>203236.79</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>162</td>
        <td>94310.98</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>175</td>
        <td>24371.95</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>177</td>
        <td>90685.56</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>173</td>
        <td>426018.7</td>
    </tr>
    <tr>
        <td>1998</td>
        <td>174</td>
        <td>258841.2</td>
    </tr>
    <tr>
        <td>1998</td>
        <td>158</td>
        <td>224240.07</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>159</td>
        <td>163403.76</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>170</td>
        <td>79950.04</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>150</td>
        <td>76638.75</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>148</td>
        <td>64039.34</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>155</td>
        <td>32005</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>161</td>
        <td>53927.44</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>166</td>
        <td>141683.55</td>
    </tr>
    <tr>
        <td>1998</td>
        <td>145</td>
        <td>311761.02</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>147</td>
        <td>193319.44</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>146</td>
        <td>89197.23</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>151</td>
        <td>39957.53</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>162</td>
        <td>16259.5</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>154</td>
        <td>116769.25</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>171</td>
        <td>14145.59</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>148</td>
        <td>1557.54</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>152</td>
        <td>97859.24</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>160</td>
        <td>77893.94</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>165</td>
        <td>145408.5</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>164</td>
        <td>145790.31</td>
    </tr>
</table>


<ul>
<li>(2) (1) 결과에서 연도별 최대, 최소 매출액 구하기</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    years</span><br><span class="line">    , <span class="built_in">MAX</span>(amount_sold) <span class="keyword">AS</span> max_sold</span><br><span class="line">    , <span class="built_in">MIN</span>(amount_sold) <span class="keyword">AS</span> min_sold</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> </span><br><span class="line">        SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">as</span> years</span><br><span class="line">        , a.employee_id</span><br><span class="line">        , <span class="built_in">SUM</span>(a.amount_sold) <span class="keyword">AS</span> amount_sold</span><br><span class="line">      <span class="keyword">FROM</span> </span><br><span class="line">        sales a</span><br><span class="line">        , customers b </span><br><span class="line">        , countries c </span><br><span class="line">      <span class="keyword">WHERE</span> a.cust_id <span class="operator">=</span> b.cust_id</span><br><span class="line">        <span class="keyword">AND</span> b.country_id <span class="operator">=</span> c.country_id </span><br><span class="line">        <span class="keyword">AND</span> c.country_name <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span> </span><br><span class="line">      <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>), a.employee_id) K </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> years</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> years</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>years</th>
        <th>max_sold</th>
        <th>min_sold</th>
    </tr>
    <tr>
        <td>1998</td>
        <td>311761.02</td>
        <td>5404.82</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>193319.44</td>
        <td>4646.74</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>142987.82</td>
        <td>16259.5</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>426018.7</td>
        <td>1557.54</td>
    </tr>
</table>


<ul>
<li>(3) (1) 결과와 (2) 결과를 조인해서</li>
<li>최대매출, 최소매출액을 일으킨 사원을 찾는다.SELECT<br>  emp.years<br>  , emp.employee_id<br>  , emp.amount_sold<br>FROM<br>  () emp                 – (1) 결과를 대입<br>  , () sale              – (2) 결과를 대입<br>WHERE emp.years &#x3D; sales.years<br>  AND emp.amount_sold &#x3D; sale.max_sold<br>ORDER BY years;</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="operator">%</span><span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    emp.years</span><br><span class="line">    , emp.employee_id</span><br><span class="line">    , emp2.emp_name</span><br><span class="line">    , emp.amount_sold</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    (<span class="keyword">SELECT</span> </span><br><span class="line">        SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">as</span> years</span><br><span class="line">        , a.employee_id</span><br><span class="line">        , <span class="built_in">SUM</span>(a.amount_sold) <span class="keyword">AS</span> amount_sold</span><br><span class="line">     <span class="keyword">FROM</span> </span><br><span class="line">        sales a</span><br><span class="line">        , customers b </span><br><span class="line">        , countries c </span><br><span class="line">     <span class="keyword">WHERE</span> a.cust_id <span class="operator">=</span> b.cust_id</span><br><span class="line">        <span class="keyword">AND</span> b.country_id <span class="operator">=</span> c.country_id </span><br><span class="line">        <span class="keyword">AND</span> c.country_name <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span> </span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>), a.employee_id) emp</span><br><span class="line">    , (<span class="keyword">SELECT</span> </span><br><span class="line">         years</span><br><span class="line">         , <span class="built_in">MAX</span>(amount_sold) <span class="keyword">AS</span> max_sold</span><br><span class="line">         , <span class="built_in">MIN</span>(amount_sold) <span class="keyword">AS</span> min_sold</span><br><span class="line">         <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> </span><br><span class="line">                 SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">as</span> years</span><br><span class="line">                 , a.employee_id</span><br><span class="line">                 , <span class="built_in">SUM</span>(a.amount_sold) <span class="keyword">AS</span> amount_sold</span><br><span class="line">               <span class="keyword">FROM</span> </span><br><span class="line">                sales a</span><br><span class="line">                , customers b </span><br><span class="line">                , countries c </span><br><span class="line">               <span class="keyword">WHERE</span> a.cust_id <span class="operator">=</span> b.cust_id</span><br><span class="line">                  <span class="keyword">AND</span> b.country_id <span class="operator">=</span> c.country_id </span><br><span class="line">                  <span class="keyword">AND</span> c.country_name <span class="operator">=</span> <span class="string">&#x27;Italy&#x27;</span> </span><br><span class="line">               <span class="keyword">GROUP</span> <span class="keyword">BY</span> SUBSTR(a.sales_month, <span class="number">1</span>, <span class="number">4</span>), a.employee_id) K </span><br><span class="line">         <span class="keyword">GROUP</span> <span class="keyword">BY</span> years) sale</span><br><span class="line">    , employees emp2</span><br><span class="line"><span class="keyword">WHERE</span> emp.years <span class="operator">=</span> sale.years</span><br><span class="line">    <span class="keyword">AND</span> emp.amount_sold <span class="operator">=</span> sale.max_sold</span><br><span class="line">    <span class="keyword">AND</span> emp.employee_id <span class="operator">=</span> emp2.employee_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> years</span><br></pre></td></tr></table></figure>

<pre><code> * oracle://ora_user:***@127.0.0.1:1521/myoracle
0 rows affected.
</code></pre>
<table>
    <tr>
        <th>years</th>
        <th>employee_id</th>
        <th>emp_name</th>
        <th>amount_sold</th>
    </tr>
    <tr>
        <td>1998</td>
        <td>145</td>
        <td>John Russell</td>
        <td>311761.02</td>
    </tr>
    <tr>
        <td>1999</td>
        <td>147</td>
        <td>Alberto Errazuriz</td>
        <td>193319.44</td>
    </tr>
    <tr>
        <td>2000</td>
        <td>153</td>
        <td>Christopher Olsen</td>
        <td>142987.82</td>
    </tr>
    <tr>
        <td>2001</td>
        <td>173</td>
        <td>Sundita Kumar</td>
        <td>426018.7</td>
    </tr>
</table>


<ul>
<li>Reference : 오라클 SQL과 PL&#x2F;SQL을 다루는 기술</li>
</ul>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/8/">8</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">75</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">39</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">24</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/JavaScript/"><span class="level-start"><span class="level-item">JavaScript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/JavaScript/%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9/"><span class="level-start"><span class="level-item">생활코딩</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/R/"><span class="level-start"><span class="level-item">R</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/R/%EA%B8%B0%EC%B4%88/"><span class="level-start"><span class="level-item">기초</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/R/%EB%B6%84%EC%84%9D-%EB%B0%A9%EB%B2%95/"><span class="level-start"><span class="level-item">분석 방법</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/SQL/"><span class="level-start"><span class="level-item">SQL</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/SQL/PL-SQL/"><span class="level-start"><span class="level-item">PL/SQL</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/SQL/oracle/"><span class="level-start"><span class="level-item">oracle</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/SQL/postgreSQL/"><span class="level-start"><span class="level-item">postgreSQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/git/github-blog/"><span class="level-start"><span class="level-item">github blog</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/python/"><span class="level-start"><span class="level-item">python</span></span><span class="level-end"><span class="level-item tag">34</span></span></a><ul><li><a class="level is-mobile" href="/categories/python/library/"><span class="level-start"><span class="level-item">library</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/python/library/numpy/"><span class="level-start"><span class="level-item">numpy</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/library/pandas/"><span class="level-start"><span class="level-item">pandas</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/python/library/pyspark/"><span class="level-start"><span class="level-item">pyspark</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/python/library/visualization/"><span class="level-start"><span class="level-item">visualization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/python/machine-learning/"><span class="level-start"><span class="level-item">machine learning</span></span><span class="level-end"><span class="level-item tag">22</span></span></a><ul><li><a class="level is-mobile" href="/categories/python/machine-learning/%EA%B0%9C%EB%85%90/"><span class="level-start"><span class="level-item">개념</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/machine-learning/%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC/"><span class="level-start"><span class="level-item">데이터 전처리</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/machine-learning/%EB%94%A5%EB%9F%AC%EB%8B%9D/"><span class="level-start"><span class="level-item">딥러닝</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/python/machine-learning/%EB%B9%84%EC%A7%80%EB%8F%84%ED%95%99%EC%8A%B5/"><span class="level-start"><span class="level-item">비지도학습</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/python/machine-learning/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/"><span class="level-start"><span class="level-item">알고리즘</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/python/machine-learning/%EC%9D%B8%EA%B3%B5%EC%8B%A0%EA%B2%BD%EB%A7%9D/"><span class="level-start"><span class="level-item">인공신경망</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/python/%EA%B8%B0%EC%B4%88%EB%AC%B8%EB%B2%95/"><span class="level-start"><span class="level-item">기초문법</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/python/%EA%B8%B0%EC%B4%88%EB%AC%B8%EB%B2%95/%EC%9E%90%EB%A3%8C%ED%98%95-%EB%B0%98%EB%B3%B5%EB%AC%B8-%EC%A1%B0%EA%B1%B4%EB%AC%B8/"><span class="level-start"><span class="level-item">자료형, 반복문, 조건문</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/%EA%B8%B0%EC%B4%88%EB%AC%B8%EB%B2%95/%ED%81%B4%EB%9E%98%EC%8A%A4/"><span class="level-start"><span class="level-item">클래스</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/%EA%B8%B0%EC%B4%88%EB%AC%B8%EB%B2%95/%ED%95%A8%EC%88%98/"><span class="level-start"><span class="level-item">함수</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/setting/"><span class="level-start"><span class="level-item">setting</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/setting/NiFi/"><span class="level-start"><span class="level-item">NiFi</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/VScode/"><span class="level-start"><span class="level-item">VScode</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/airflow/"><span class="level-start"><span class="level-item">airflow</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/anaconda/"><span class="level-start"><span class="level-item">anaconda</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/crawling/"><span class="level-start"><span class="level-item">crawling</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/elasticsearch/"><span class="level-start"><span class="level-item">elasticsearch</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/oracle/"><span class="level-start"><span class="level-item">oracle</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/postgreSQL/"><span class="level-start"><span class="level-item">postgreSQL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/spark/"><span class="level-start"><span class="level-item">spark</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/setting/wsl2/"><span class="level-start"><span class="level-item">wsl2</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-22T00:00:00.000Z">2022-05-22</time></p><p class="title"><a href="/2022/05/22/PL_SQL_ML/">PL/SQL - ML</a></p><p class="categories"><a href="/categories/SQL/">SQL</a> / <a href="/categories/SQL/PL-SQL/">PL/SQL</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-21T00:00:00.000Z">2022-05-21</time></p><p class="title"><a href="/2022/05/21/PL_SQL_practice_2/">PL/SQL practice02</a></p><p class="categories"><a href="/categories/SQL/">SQL</a> / <a href="/categories/SQL/PL-SQL/">PL/SQL</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-20T00:00:00.000Z">2022-05-20</time></p><p class="title"><a href="/2022/05/20/PL_SQL_practice_1/">PL/SQL practice01</a></p><p class="categories"><a href="/categories/SQL/">SQL</a> / <a href="/categories/SQL/PL-SQL/">PL/SQL</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-19T00:00:00.000Z">2022-05-19</time></p><p class="title"><a href="/2022/05/19/PL_SQL_start/">PL/SQL start</a></p><p class="categories"><a href="/categories/SQL/">SQL</a> / <a href="/categories/SQL/PL-SQL/">PL/SQL</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-18T00:00:00.000Z">2022-05-18</time></p><p class="title"><a href="/2022/05/18/Oracle_test0/">Oracle_practice</a></p><p class="categories"><a href="/categories/SQL/">SQL</a> / <a href="/categories/SQL/oracle/">oracle</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NiFi/"><span class="tag">NiFi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Notion/"><span class="tag">Notion</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PL-SQL/"><span class="tag">PL/SQL</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/R/"><span class="tag">R</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/R-Markdown/"><span class="tag">R Markdown</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VScord/"><span class="tag">VScord</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/airflow/"><span class="tag">airflow</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/anaconda/"><span class="tag">anaconda</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache/"><span class="tag">apache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crawling/"><span class="tag">crawling</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/elasticsearch/"><span class="tag">elasticsearch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github-blog/"><span class="tag">github blog</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kibana/"><span class="tag">kibana</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/oracle/"><span class="tag">oracle</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pipeline/"><span class="tag">pipeline</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgreSQL/"><span class="tag">postgreSQL</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">30</span></a></div><div class="control"><a class="tags has-addons" href="/tags/setting/"><span class="tag">setting</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spark/"><span class="tag">spark</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wsl2/"><span class="tag">wsl2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9/"><span class="tag">생활코딩</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="kmk3593 blog" height="28"></a><p class="is-size-7"><span>&copy; 2022 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>